import{_ as V,c as r,o as i,a as e,t as o,f,F as A,g as L,n as N,b as m,i as F,j as M,v as R,O as q,L as _,C as H,P as T,N as g,S as u}from"./app-BLvk--SP.js";const I={name:"Users",setup(){const l=_([]),s=_([]),w=_(!1),n=_(null),y=_(null),S=_(null),b=_({name:"",email:"",password:"",role:""}),v=async()=>{try{const a=await g.get("/dashboard/users");l.value=a.data.data.data}catch(a){console.error("Error fetching users:",a)}},C=async()=>{try{const a=await g.get("/dashboard/roles");s.value=a.data.filter(d=>d.name!=="super_user")}catch(a){console.error("Error fetching roles:",a)}},k=()=>{w.value=!1,b.value={name:"",email:"",password:"",role:""},y.value.show()},U=a=>{var d;w.value=!0,b.value={id:a.id,name:a.name,email:a.email,password:"",role:((d=a.roles[0])==null?void 0:d.name)||""},y.value.show()},$=a=>{n.value=a,S.value.show()},D=async()=>{var a,d;try{w.value?await g.put(`/dashboard/users/${b.value.id}`,b.value):await g.post("/dashboard/users",b.value),await v(),y.value.hide(),u.fire({icon:"success",title:w.value?"User Updated":"User Created",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(c){console.error("Error saving user:",c),u.fire({icon:"error",title:"Error",text:((d=(a=c.response)==null?void 0:a.data)==null?void 0:d.message)||"Failed to save user"})}},B=a=>{u.fire({title:"Are you sure?",text:"This will soft delete the user. They won't be able to login but their data will be preserved.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(async d=>{var c,h;if(d.isConfirmed)try{await g.delete(`/dashboard/users/${a.id}`),await v(),u.fire({icon:"success",title:"User Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(p){console.error("Error deleting user:",p),u.fire({icon:"error",title:"Error",text:((h=(c=p.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to delete user"})}})},t=a=>{u.fire({title:"Are you absolutely sure?",text:"This will permanently delete the user. This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, permanently delete!"}).then(async d=>{var c,h;if(d.isConfirmed)try{await g.delete(`/dashboard/users/${a.id}/force`),await v(),u.fire({icon:"success",title:"User Permanently Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(p){console.error("Error permanently deleting user:",p),u.fire({icon:"error",title:"Error",text:((h=(c=p.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to permanently delete user"})}})},E=async a=>{var d,c;try{await g.post(`/dashboard/users/${a.id}/restore`),await v(),u.fire({icon:"success",title:"User Restored",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(h){console.error("Error restoring user:",h),u.fire({icon:"error",title:"Error",text:((c=(d=h.response)==null?void 0:d.data)==null?void 0:c.message)||"Failed to restore user"})}};return H(()=>{y.value=new T(document.getElementById("userModal")),S.value=new T(document.getElementById("viewUserModal")),v(),C()}),{users:l,availableRoles:s,isEditing:w,selectedUser:n,form:b,showCreateModal:k,editUser:U,viewUser:$,saveUser:D,confirmDelete:B,confirmHardDelete:t,restoreUser:E}}},j={class:"users-page"},P={class:"d-flex justify-content-between align-items-center mb-4"},Y={class:"mb-0"},z={class:"card"},O={class:"card-body"},G={class:"table-responsive"},J={class:"table table-hover table-sm"},K={class:"d-none d-md-table-cell"},Q={class:"d-none d-md-table-cell"},W={class:"d-none d-md-table-cell"},X={class:"d-none d-md-table-cell"},Z={class:"fw-bold"},x={class:"small text-muted"},ee={class:"d-md-none small mt-1"},te={class:"badge bg-info"},se={class:"mt-1"},oe={class:"btn-group"},le=["onClick"],ne=["onClick"],ae=["onClick"],de=["onClick"],re=["onClick"],ie={class:"d-none d-md-table-cell"},ce={class:"d-none d-md-table-cell"},me={class:"badge bg-info"},ue={class:"d-none d-md-table-cell"},be={class:"d-none d-md-table-cell"},fe={class:"d-none d-md-table-cell"},ve={class:"btn-group"},he=["onClick"],_e=["onClick"],ge=["onClick"],we=["onClick"],ye=["onClick"],pe={class:"modal fade",id:"userModal",tabindex:"-1"},Ce={class:"modal-dialog"},ke={class:"modal-content"},Ue={class:"modal-header"},$e={class:"modal-title"},De={class:"modal-body"},Be={class:"mb-3"},Ee={class:"form-label"},Me={class:"mb-3"},Se={class:"form-label"},Ne={class:"mb-3"},Re={class:"form-label"},Ae=["required"],Le={key:0,class:"text-muted"},Te={class:"mb-3"},Ve={class:"form-label"},Fe={value:""},qe=["value"],He={class:"text-end"},Ie={type:"button",class:"btn btn-secondary me-2","data-bs-dismiss":"modal"},je={type:"submit",class:"btn btn-primary"},Pe={class:"modal fade",id:"viewUserModal",tabindex:"-1"},Ye={class:"modal-dialog"},ze={class:"modal-content"},Oe={class:"modal-header"},Ge={class:"modal-title"},Je={class:"modal-body"},Ke={class:"user-details"},Qe={key:0},We={class:"modal-footer"},Xe={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"};function Ze(l,s,w,n,y,S){var b,v,C,k,U,$,D,B;return i(),r("div",j,[e("div",P,[e("h4",Y,o(l.$t("users")),1),e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=(...t)=>n.showCreateModal&&n.showCreateModal(...t))},[s[6]||(s[6]=e("i",{class:"fas fa-plus me-2"},null,-1)),f(o(l.$t("common.create")),1)])]),e("div",z,[e("div",O,[e("div",G,[e("table",J,[e("thead",null,[e("tr",null,[e("th",null,o(l.$t("auth.register.restaurantName")||"Name"),1),e("th",null,o(l.$t("auth.login.email")),1),e("th",K,o(l.$t("role")),1),e("th",Q,o(l.$t("status")||"Status"),1),e("th",W,o(l.$t("createdAt")||"Created At"),1),e("th",X,o(l.$t("common.actions")),1)])]),e("tbody",null,[(i(!0),r(A,null,L(n.users,t=>{var E,a;return i(),r("tr",{key:t.id,class:N(["d-block d-md-table-row w-100 mb-2 mb-md-0",{"table-danger":t.deleted_at}])},[e("td",null,[e("div",Z,o(t.name),1),e("div",x,o(t.email),1),e("div",ee,[e("div",null,[f(o(l.$t("role"))+": ",1),e("span",te,o(((E=t.roles[0])==null?void 0:E.name)||l.$t("noRole")||"No Role"),1)]),e("div",null,[f(o(l.$t("status")||"Status")+": ",1),e("span",{class:N(["badge",t.deleted_at?"bg-danger":"bg-success"])},o(t.deleted_at?l.$t("deleted")||"Deleted":l.$t("active")||"Active"),3)]),e("div",null,o(l.$t("created")||"Created")+": "+o(new Date(t.created_at).toLocaleDateString()),1),e("div",se,[e("div",oe,[e("button",{class:"btn btn-sm btn-info me-1",onClick:d=>n.viewUser(t)},s[7]||(s[7]=[e("i",{class:"fas fa-eye"},null,-1)]),8,le),t.deleted_at?m("",!0):(i(),r("button",{key:0,class:"btn btn-sm btn-primary me-1",onClick:d=>n.editUser(t)},s[8]||(s[8]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ne)),t.deleted_at?m("",!0):(i(),r("button",{key:1,class:"btn btn-sm btn-danger me-1",onClick:d=>n.confirmDelete(t)},s[9]||(s[9]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ae)),t.deleted_at?(i(),r("button",{key:2,class:"btn btn-sm btn-warning me-1",onClick:d=>n.restoreUser(t)},s[10]||(s[10]=[e("i",{class:"fas fa-undo"},null,-1)]),8,de)):m("",!0),t.deleted_at?(i(),r("button",{key:3,class:"btn btn-sm btn-danger",onClick:d=>n.confirmHardDelete(t)},s[11]||(s[11]=[e("i",{class:"fas fa-times"},null,-1)]),8,re)):m("",!0)])])])]),e("td",ie,o(t.email),1),e("td",ce,[e("span",me,o(((a=t.roles[0])==null?void 0:a.name)||l.$t("noRole")||"No Role"),1)]),e("td",ue,[e("span",{class:N(["badge",t.deleted_at?"bg-danger":"bg-success"])},o(t.deleted_at?l.$t("deleted")||"Deleted":l.$t("active")||"Active"),3)]),e("td",be,o(new Date(t.created_at).toLocaleDateString()),1),e("td",fe,[e("div",ve,[e("button",{class:"btn btn-sm btn-info me-1",onClick:d=>n.viewUser(t)},s[12]||(s[12]=[e("i",{class:"fas fa-eye"},null,-1)]),8,he),t.deleted_at?m("",!0):(i(),r("button",{key:0,class:"btn btn-sm btn-primary me-1",onClick:d=>n.editUser(t)},s[13]||(s[13]=[e("i",{class:"fas fa-edit"},null,-1)]),8,_e)),t.deleted_at?m("",!0):(i(),r("button",{key:1,class:"btn btn-sm btn-danger me-1",onClick:d=>n.confirmDelete(t)},s[14]||(s[14]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ge)),t.deleted_at?(i(),r("button",{key:2,class:"btn btn-sm btn-warning me-1",onClick:d=>n.restoreUser(t)},s[15]||(s[15]=[e("i",{class:"fas fa-undo"},null,-1)]),8,we)):m("",!0),t.deleted_at?(i(),r("button",{key:3,class:"btn btn-sm btn-danger",onClick:d=>n.confirmHardDelete(t)},s[16]||(s[16]=[e("i",{class:"fas fa-times"},null,-1)]),8,ye)):m("",!0)])])],2)}),128))])])])])]),e("div",pe,[e("div",Ce,[e("div",ke,[e("div",Ue,[e("h5",$e,o(n.isEditing?(l.$t("common.edit")||"Edit")+" "+(l.$t("users")||"Users"):(l.$t("common.create")||"Create")+" "+(l.$t("users")||"Users")),1),s[17]||(s[17]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),e("div",De,[e("form",{onSubmit:s[5]||(s[5]=F((...t)=>n.saveUser&&n.saveUser(...t),["prevent"]))},[e("div",Be,[e("label",Ee,o(l.$t("auth.register.restaurantName")||"Name"),1),M(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>n.form.name=t),required:""},null,512),[[R,n.form.name]])]),e("div",Me,[e("label",Se,o(l.$t("auth.login.email")),1),M(e("input",{type:"email",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=t=>n.form.email=t),required:""},null,512),[[R,n.form.email]])]),e("div",Ne,[e("label",Re,o(l.$t("auth.login.password")),1),M(e("input",{type:"password",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=t=>n.form.password=t),required:!n.isEditing},null,8,Ae),[[R,n.form.password]]),n.isEditing?(i(),r("small",Le,o(l.$t("usersLeaveBlank")||"Leave blank to keep current password"),1)):m("",!0)]),e("div",Te,[e("label",Ve,o(l.$t("role")),1),M(e("select",{class:"form-select","onUpdate:modelValue":s[4]||(s[4]=t=>n.form.role=t),required:""},[e("option",Fe,o(l.$t("selectRole")||"Select Role"),1),(i(!0),r(A,null,L(n.availableRoles,t=>(i(),r("option",{key:t.id,value:t.name},o(t.name),9,qe))),128))],512),[[q,n.form.role]])]),e("div",He,[e("button",Ie,o(l.$t("common.cancel")),1),e("button",je,o(l.$t("common.save")),1)])],32)])])])]),e("div",Pe,[e("div",Ye,[e("div",ze,[e("div",Oe,[e("h5",Ge,o(l.$t("userDetails")||"User Details"),1),s[18]||(s[18]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),e("div",Je,[e("div",Ke,[e("p",null,[e("strong",null,o(l.$t("name")||"Name")+":",1),f(" "+o((b=n.selectedUser)==null?void 0:b.name),1)]),e("p",null,[e("strong",null,o(l.$t("auth.login.email"))+":",1),f(" "+o((v=n.selectedUser)==null?void 0:v.email),1)]),e("p",null,[e("strong",null,o(l.$t("role"))+":",1),f(" "+o(((k=(C=n.selectedUser)==null?void 0:C.roles[0])==null?void 0:k.name)||l.$t("noRole")||"No Role"),1)]),e("p",null,[e("strong",null,o(l.$t("status")||"Status")+":",1),f(" "+o((U=n.selectedUser)!=null&&U.deleted_at?l.$t("deleted")||"Deleted":l.$t("active")||"Active"),1)]),e("p",null,[e("strong",null,o(l.$t("createdAt")||"Created At")+":",1),f(" "+o(new Date(($=n.selectedUser)==null?void 0:$.created_at).toLocaleString()),1)]),(D=n.selectedUser)!=null&&D.deleted_at?(i(),r("p",Qe,[s[19]||(s[19]=e("strong",null,"Deleted At:",-1)),f(" "+o(new Date((B=n.selectedUser)==null?void 0:B.deleted_at).toLocaleString()),1)])):m("",!0)])]),e("div",We,[e("button",Xe,o(l.$t("common.close")||"Close"),1)])])])])])}const et=V(I,[["render",Ze],["__scopeId","data-v-f260af42"]]);export{et as default};
//# sourceMappingURL=Users-YT91d4AN.js.map
