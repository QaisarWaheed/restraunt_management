import{_ as q,c as n,a as t,f as c,j as M,v as T,O as R,e as H,w as Y,r as z,t as l,i as J,J as Q,b as h,F as G,g as K,L as u,C as W,P as I,T as X,N as f,S as m,o as r,n as U}from"./app-BLvk--SP.js";import{d as Z}from"./vuedraggable.umd-BKuQl9O6.js";const $={name:"Categories",components:{draggable:Z},setup(){const S=u([]),e=u([]),_=u(!1),o=u(null),x=u(null),V=u(null),k=u(!1),E=u([]),B=async()=>{try{const a=await f.get("/tenant/categories",{params:{only_deleted:!0}});E.value=a.data.data.data,w.value.show()}catch(a){console.error("Error fetching deleted categories:",a),m.fire({icon:"error",title:"Error",text:"Failed to fetch deleted categories"})}},w=u(null),v=u({name:"",description:"",parent_id:"",is_active:!0,sort_order:0,image:""}),g=u({search:"",parent_id:"",is_active:""}),b=async()=>{k.value=!0;try{const a={};g.value.search&&(a.search=g.value.search),g.value.parent_id&&(a.parent_id=g.value.parent_id),g.value.is_active!==""&&(a.is_active=g.value.is_active);const i=await f.get("/tenant/categories",{params:a});S.value=i.data.data.data}catch(a){console.error("Error fetching categories:",a)}finally{k.value=!1}},y=async()=>{try{const a=await f.get("/tenant/categories");e.value=a.data.data.data}catch(a){console.error("Error fetching parent categories:",a)}},A=()=>{_.value=!1,v.value={name:"",description:"",parent_id:"",is_active:!0,sort_order:0,image:""},x.value.show()},F=a=>{_.value=!0,v.value={id:a.id,name:a.name,description:a.description,parent_id:a.parent_id,is_active:a.is_active,sort_order:a.sort_order,image:a.image},x.value.show()},N=a=>{o.value=a,V.value.show()},s=async()=>{var a,i;try{_.value?await f.put(`/tenant/categories/${v.value.id}`,v.value):await f.post("/tenant/categories",v.value),await b(),await y(),x.value.hide(),m.fire({icon:"success",title:_.value?"Category Updated":"Category Created",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(d){console.error("Error saving category:",d),m.fire({icon:"error",title:"Error",text:((i=(a=d.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to save category"})}},p=a=>{m.fire({title:"Are you sure?",text:"This will delete the category. This action can be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(async i=>{var d,C;if(i.isConfirmed)try{await f.delete(`/tenant/categories/${a.id}`),await b(),await y(),m.fire({icon:"success",title:"Category Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(D){console.error("Error deleting category:",D),m.fire({icon:"error",title:"Error",text:((C=(d=D.response)==null?void 0:d.data)==null?void 0:C.message)||"Failed to delete category"})}})},L=a=>{m.fire({title:"Are you absolutely sure?",text:"This will permanently delete the category. This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, permanently delete!"}).then(async i=>{var d,C;if(i.isConfirmed)try{await f.delete(`/tenant/categories/${a.id}/force`),await b(),await y(),m.fire({icon:"success",title:"Category Permanently Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(D){console.error("Error permanently deleting category:",D),m.fire({icon:"error",title:"Error",text:((C=(d=D.response)==null?void 0:d.data)==null?void 0:C.message)||"Failed to permanently delete category"})}})},O=async a=>{var i,d;try{await f.post(`/tenant/categories/${a.id}/restore`),await b(),await y(),m.fire({icon:"success",title:"Category Restored",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(C){console.error("Error restoring category:",C),m.fire({icon:"error",title:"Error",text:((d=(i=C.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to restore category"})}},P=()=>{b()},j=async()=>{try{const a=S.value.map((i,d)=>({id:i.id,sort_order:d}));await f.post("/tenant/categories/reorder",{order:a}),await b(),m.fire({icon:"success",title:"Order updated",toast:!0,position:"top-end",showConfirmButton:!1,timer:1500})}catch{m.fire({icon:"error",title:"Error",text:"Failed to update order"})}};return W(()=>{x.value=new I(document.getElementById("CategoryModal")),V.value=new I(document.getElementById("viewCategoryModal")),w.value=new I(document.getElementById("deletedCategoriesModal")),b(),y(),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(a=>{new X(a)})}),{categories:S,parentCategories:e,isEditing:_,selectedCategory:o,form:v,showCreateModal:A,editCategory:F,viewCategory:N,saveCategory:s,confirmDelete:p,confirmHardDelete:L,restoreCategory:O,filters:g,applyFilters:P,loading:k,deletedCategories:E,showDeletedModal:B,deletedCategoriesModal:w,onSortEnd:j}}},tt={class:"Categories-page"},et={class:"d-flex justify-content-between align-items-center mb-4"},ot={class:"mb-4"},st={class:"filter-body"},at={class:"row g-3 align-items-end"},lt={class:"col-md-4"},nt={class:"col-md-4"},rt={class:"card"},it={class:"card-body"},dt={key:0,class:"text-center py-5"},ct={key:1,class:"text-center py-5 text-muted"},mt={key:2,class:"table-responsive"},ut={class:"table table-hover table-sm Categories-table"},gt={class:"fw-bold"},bt={class:"small text-muted"},vt={class:"d-none d-md-table-cell"},ft={class:"d-none d-md-table-cell"},yt={class:"d-none d-md-table-cell"},Ct={class:"d-none d-md-table-cell"},pt={class:"btn-group"},_t=["onClick"],wt=["onClick"],ht=["onClick"],xt=["onClick"],kt=["onClick"],Et={class:"modal fade",id:"CategoryModal",tabindex:"-1"},Dt={class:"modal-dialog modal-lg"},Mt={class:"modal-content Category-modal-content"},St={class:"modal-header Category-modal-header"},Bt={class:"modal-title Category-modal-title"},At={class:"modal-body Category-modal-body"},Ft={class:"row g-3 mb-3"},Nt={class:"col-md-6"},Vt={class:"input-group"},Tt={class:"col-md-6"},It={class:"form-check form-switch mt-2"},Ut={class:"col-12"},Lt={class:"input-group"},Ot={class:"modal-footer Category-modal-footer"},Pt={type:"submit",class:"btn btn-submit"},jt={class:"modal fade",id:"viewCategoryModal",tabindex:"-1"},qt={class:"modal-dialog"},Rt={class:"modal-content"},Ht={class:"modal-body"},Yt={class:"Category-details"},zt={key:0},Jt=["src"],Qt={key:1},Gt={class:"modal fade",id:"deletedCategoriesModal",tabindex:"-1"},Kt={class:"modal-dialog modal-lg"},Wt={class:"modal-content"},Xt={class:"modal-body"},Zt={key:0,class:"text-center py-4 text-muted"},$t={key:1,class:"table-responsive"},te={class:"table table-hover table-sm"},ee=["onClick"];function oe(S,e,_,o,x,V){var E,B,w,v,g,b,y,A,F,N;const k=z("draggable");return r(),n("div",tt,[t("div",et,[t("div",null,[t("button",{class:"btn btn-outline-secondary me-2",onClick:e[0]||(e[0]=(...s)=>o.showDeletedModal&&o.showDeletedModal(...s))},e[11]||(e[11]=[t("i",{class:"fas fa-trash-restore-alt me-1"},null,-1),c(" Deleted Categories ")]))]),e[13]||(e[13]=t("h4",{class:"mb-0"},"Manage Categories",-1)),t("button",{class:"btn btn-add-Category",onClick:e[1]||(e[1]=(...s)=>o.showCreateModal&&o.showCreateModal(...s))},e[12]||(e[12]=[t("i",{class:"fas fa-plus me-2"},null,-1),c("Add Category ")]))]),t("div",ot,[t("div",st,[t("div",at,[t("div",lt,[e[14]||(e[14]=t("label",{class:"form-label mb-1"},"Search",-1)),M(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.filters.search=s),onInput:e[3]||(e[3]=(...s)=>o.applyFilters&&o.applyFilters(...s)),type:"text",class:"form-control filter-input",placeholder:"Search by name or description"},null,544),[[T,o.filters.search]])]),t("div",nt,[e[16]||(e[16]=t("label",{class:"form-label mb-1"},"Status",-1)),M(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.filters.is_active=s),onChange:e[5]||(e[5]=(...s)=>o.applyFilters&&o.applyFilters(...s)),class:"form-select filter-input"},e[15]||(e[15]=[t("option",{value:""},"All",-1),t("option",{value:!0},"Active",-1),t("option",{value:!1},"Inactive",-1)]),544),[[R,o.filters.is_active]])])])])]),t("div",rt,[t("div",it,[o.loading?(r(),n("div",dt,e[17]||(e[17]=[t("div",{class:"spinner-border text-danger",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)]))):o.categories.length===0?(r(),n("div",ct,e[18]||(e[18]=[t("i",{class:"fas fa-store fa-3x mb-3",style:{color:"#bdbdbd"}},null,-1),t("div",{class:"h5 mb-2"},"No Categories Found",-1),t("div",null,[c("No categories match your search criteria."),t("br"),c("Try adjusting your filters.")],-1)]))):(r(),n("div",mt,[t("table",ut,[e[25]||(e[25]=t("thead",null,[t("tr",null,[t("th",{style:{width:"32px"}}),t("th",null,"Name"),t("th",{class:"d-none d-md-table-cell"},"Status"),t("th",{class:"d-none d-md-table-cell"},"Sort Order"),t("th",{class:"d-none d-md-table-cell"},"Created At"),t("th",{class:"d-none d-md-table-cell"},"Actions")])],-1)),H(k,{modelValue:o.categories,"onUpdate:modelValue":e[6]||(e[6]=s=>o.categories=s),onEnd:o.onSortEnd,tag:"tbody",animation:200,handle:".drag-handle"},{item:Y(({element:s})=>[(r(),n("tr",{key:s.id,class:U(["d-block d-md-table-row w-100 mb-2 mb-md-0",{"table-danger":s.deleted_at}])},[e[24]||(e[24]=t("td",null,[t("span",{class:"drag-handle",style:{cursor:"grab"}},[t("i",{class:"fas fa-grip-vertical"})])],-1)),t("td",null,[t("div",gt,l(s.name),1),t("div",bt,l(s.description),1)]),t("td",vt,[t("span",{class:U(["badge",s.is_active?"bg-success":"bg-danger"])},l(s.is_active?"Active":"Inactive"),3)]),t("td",ft,l(s.sort_order),1),t("td",yt,l(new Date(s.created_at).toLocaleDateString()),1),t("td",Ct,[t("div",pt,[t("button",{class:"btn btn-sm btn-action btn-view me-1",onClick:p=>o.viewCategory(s)},e[19]||(e[19]=[t("i",{class:"fas fa-eye"},null,-1)]),8,_t),s.deleted_at?h("",!0):(r(),n("button",{key:0,class:"btn btn-sm btn-action btn-edit me-1",onClick:p=>o.editCategory(s)},e[20]||(e[20]=[t("i",{class:"fas fa-edit"},null,-1)]),8,wt)),s.deleted_at?h("",!0):(r(),n("button",{key:1,class:"btn btn-sm btn-action btn-delete me-1",onClick:p=>o.confirmDelete(s)},e[21]||(e[21]=[t("i",{class:"fas fa-trash"},null,-1)]),8,ht)),s.deleted_at?(r(),n("button",{key:2,class:"btn btn-sm btn-action btn-restore me-1",onClick:p=>o.restoreCategory(s)},e[22]||(e[22]=[t("i",{class:"fas fa-undo"},null,-1)]),8,xt)):h("",!0),s.deleted_at?(r(),n("button",{key:3,class:"btn btn-sm btn-action btn-hard-delete",onClick:p=>o.confirmHardDelete(s)},e[23]||(e[23]=[t("i",{class:"fas fa-times"},null,-1)]),8,kt)):h("",!0)])])],2))]),_:1},8,["modelValue","onEnd"])])]))])]),t("div",Et,[t("div",Dt,[t("div",Mt,[t("div",St,[t("h5",Bt,l(o.isEditing?"Edit Category":"Add Category"),1),e[26]||(e[26]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),t("div",At,[t("form",{onSubmit:e[10]||(e[10]=J((...s)=>o.saveCategory&&o.saveCategory(...s),["prevent"]))},[t("div",Ft,[t("div",Nt,[t("div",Vt,[e[27]||(e[27]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-tag"})],-1)),M(t("input",{id:"categoryName",type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=s=>o.form.name=s),required:"",placeholder:"Category Name"},null,512),[[T,o.form.name]])])]),t("div",Tt,[t("div",It,[M(t("input",{class:"form-check-input",type:"checkbox",id:"categoryStatus","onUpdate:modelValue":e[8]||(e[8]=s=>o.form.is_active=s)},null,512),[[Q,o.form.is_active]]),e[28]||(e[28]=t("label",{class:"form-check-label",for:"categoryStatus"},"Active",-1))])]),t("div",Ut,[t("div",Lt,[e[29]||(e[29]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-align-left"})],-1)),M(t("textarea",{id:"categoryDescription",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=s=>o.form.description=s),rows:"3",placeholder:"Category Description"},null,512),[[T,o.form.description]])])])]),t("div",Ot,[e[30]||(e[30]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",Pt,l(o.isEditing?"Update":"Create"),1)])],32)])])])]),t("div",jt,[t("div",qt,[t("div",Rt,[e[40]||(e[40]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Category Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",Ht,[t("div",Yt,[t("p",null,[e[31]||(e[31]=t("strong",null,"Name:",-1)),c(" "+l((E=o.selectedCategory)==null?void 0:E.name),1)]),t("p",null,[e[32]||(e[32]=t("strong",null,"Description:",-1)),c(" "+l((B=o.selectedCategory)==null?void 0:B.description),1)]),t("p",null,[e[33]||(e[33]=t("strong",null,"Parent:",-1)),c(" "+l(((v=(w=o.selectedCategory)==null?void 0:w.parent)==null?void 0:v.name)||"None"),1)]),t("p",null,[e[34]||(e[34]=t("strong",null,"Status:",-1)),c(" "+l((g=o.selectedCategory)!=null&&g.is_active?"Active":"Inactive"),1)]),t("p",null,[e[35]||(e[35]=t("strong",null,"Sort Order:",-1)),c(" "+l((b=o.selectedCategory)==null?void 0:b.sort_order),1)]),(y=o.selectedCategory)!=null&&y.image?(r(),n("p",zt,[e[36]||(e[36]=t("strong",null,"Image:",-1)),e[37]||(e[37]=c()),t("img",{src:o.selectedCategory.image,class:"img-thumbnail mt-2",style:{"max-width":"200px"}},null,8,Jt)])):h("",!0),t("p",null,[e[38]||(e[38]=t("strong",null,"Created At:",-1)),c(" "+l(new Date((A=o.selectedCategory)==null?void 0:A.created_at).toLocaleString()),1)]),(F=o.selectedCategory)!=null&&F.deleted_at?(r(),n("p",Qt,[e[39]||(e[39]=t("strong",null,"Deleted At:",-1)),c(" "+l(new Date((N=o.selectedCategory)==null?void 0:N.deleted_at).toLocaleString()),1)])):h("",!0)])]),e[41]||(e[41]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),t("div",Gt,[t("div",Kt,[t("div",Wt,[e[45]||(e[45]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Deleted Categories"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",Xt,[o.deletedCategories.length===0?(r(),n("div",Zt,e[42]||(e[42]=[t("i",{class:"fas fa-store-slash fa-2x mb-2"},null,-1),t("div",null,"No deleted categories found.",-1)]))):(r(),n("div",$t,[t("table",te,[e[44]||(e[44]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Description"),t("th",null,"Deleted At"),t("th",null,"Action")])],-1)),t("tbody",null,[(r(!0),n(G,null,K(o.deletedCategories,s=>(r(),n("tr",{key:s.id},[t("td",null,l(s.name),1),t("td",null,l(s.description),1),t("td",null,l(new Date(s.deleted_at).toLocaleString()),1),t("td",null,[t("button",{class:"btn btn-sm btn-success",onClick:p=>o.restoreCategory(s)},e[43]||(e[43]=[t("i",{class:"fas fa-undo"},null,-1),c(" Restore")]),8,ee)])]))),128))])])]))])])])])])}const le=q($,[["render",oe],["__scopeId","data-v-437ba8d3"]]);export{le as default};
//# sourceMappingURL=QuoteRequests-CNpgqUWH.js.map
