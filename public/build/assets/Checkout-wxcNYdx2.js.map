{"version":3,"file":"Checkout-wxcNYdx2.js","sources":["../../../resources/js/views/tenant/Checkout.vue"],"sourcesContent":["<template>\n  <div class=\"container mt-100\">\n    <div class=\"checkout-page container py-4\">\n      <div class=\"row\">\n        <div class=\"col-lg-8 mb-4\">\n          <!-- Stepper -->\n          <div class=\"checkout-steps mb-4 d-flex flex-wrap justify-content-between\">\n            <div v-for=\"(step, idx) in steps\" :key=\"step.key\" class=\"checkout-step flex-fill text-center mb-2\" :class=\"{active: currentStep === idx, done: idx < currentStep}\">\n              <span class=\"step-index\">{{ idx + 1 }}</span>\n              <span class=\"step-title\">{{ step.title }}</span>\n            </div>\n          </div>\n          <!-- Step Content -->\n          <div class=\"checkout-step-content p-4 bg-white rounded shadow-sm mb-3\">\n            <!-- Delivery Address -->\n            <form v-if=\"currentStep === 0\" @submit.prevent=\"nextStep\">\n              <h4 class=\"mb-3\">Delivery Address</h4>\n              <div class=\"row g-3\">\n                <div class=\"col-md-6 col-12\">\n                  <label class=\"form-label\">First Name*</label>\n                  <input v-model=\"address.firstName\" class=\"form-control\" required />\n                </div>\n                <div class=\"col-md-6 col-12\">\n                  <label class=\"form-label\">Last Name*</label>\n                  <input v-model=\"address.lastName\" class=\"form-control\" required />\n                </div>\n                <div class=\"col-md-6 col-12\">\n                  <label class=\"form-label\">Email*</label>\n                  <input v-model=\"address.email\" type=\"email\" class=\"form-control\" required />\n                </div>\n                <div class=\"col-md-6 col-12\">\n                  <label class=\"form-label\">Phone*</label>\n                  <input v-model=\"address.phone\" class=\"form-control\" type=\"tel\" pattern=\"[0-9\\-\\+\\s]*\" inputmode=\"tel\" required />\n                </div>\n                <div class=\"col-12\">\n                  <label class=\"form-label\">Address*</label>\n                  <textarea v-model=\"address.address\" class=\"form-control\" required></textarea>\n                </div>\n              </div>\n              <div class=\"d-flex justify-content-end mt-4\">\n                <button class=\"btn btn-danger w-100 w-md-auto\" type=\"submit\">Next</button>\n              </div>\n            </form>\n            <!-- Delivery Method -->\n            <form v-else-if=\"currentStep === 1\" @submit.prevent=\"nextStep\">\n              <h4 class=\"mb-3\">Delivery Method</h4>\n              <div class=\"form-check mb-2\">\n                <input class=\"form-check-input\" type=\"radio\" id=\"free\" value=\"free\" v-model=\"deliveryMethod\" required />\n                <label class=\"form-check-label\" for=\"free\">\n                  <b>Free Delivery</b> 0.00 / Delivery in 7 to 14 business Days\n                </label>\n              </div>\n              <div class=\"d-flex justify-content-between mt-4\">\n                <button class=\"btn btn-secondary w-50 me-2\" type=\"button\" @click=\"prevStep\">Back</button>\n                <button class=\"btn btn-danger w-50\" type=\"submit\">Next</button>\n              </div>\n            </form>\n            <!-- Order Review & Confirmation -->\n            <div v-else-if=\"currentStep === 2\">\n              <template v-if=\"!orderPlaced\">\n                <h4 class=\"mb-3\">Order Review</h4>\n                <div class=\"mb-3\">\n                  <b>Delivery Address:</b>\n                  <div>{{ address.firstName }} {{ address.lastName }}, {{ address.email }}, {{ address.phone }}</div>\n                  <div>{{ address.address }}</div>\n                </div>\n                <div class=\"mb-3\">\n                  <b>Delivery Method:</b> {{ deliveryMethodLabel }}\n                </div>\n                <div class=\"mb-3\">\n                  <b>Shopping Cart:</b>\n                  <table class=\"table table-sm\">\n                    <thead>\n                      <tr>\n                        <th>Name</th><th>Unit Price</th><th>Quantity</th><th>Total</th></tr></thead>\n                    <tbody>\n                      <tr v-for=\"item in cart.cart.items\" :key=\"item.id\">\n                        <td>{{ item.name }}</td>\n                        <td>{{ settings.currency_symbol || '$' }}&nbsp;{{ item.price }}</td>\n                        <td>{{ item.quantity }}</td>\n                        <td>{{ settings.currency_symbol || '$' }}&nbsp;{{ (item.price * item.quantity).toFixed(2) }}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                  <div class=\"d-flex justify-content-end\">\n                    <div>\n                      <div>SubTotal: {{ settings.currency_symbol || '$' }}&nbsp;{{ subtotal.toFixed(2) }}</div>\n                      <div>Discount: {{ settings.discount }}%</div>\n                      <div class=\"fw-bold\">Grand total: {{ settings.currency_symbol || '$' }}&nbsp;{{ grandTotal.toFixed(2) }}</div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"d-flex justify-content-between mt-4 flex-wrap\">\n                  <button class=\"btn btn-secondary w-50 me-2 mb-2 mb-md-0\" type=\"button\" @click=\"prevStep\">Back</button>\n                  <button class=\"btn btn-danger w-50\" @click=\"placeOrder\">Place Order Now</button>\n                </div>\n              </template>\n              <template v-else>\n                <div class=\"text-center py-5\">\n                  <h3 class=\"mb-3 text-success\">Thank You!</h3>\n                  <p>Your order has been processed.</p>\n                  <button class=\"btn btn-danger mt-3\" @click=\"goToShop\">Return to Shop</button>\n                </div>\n              </template>\n            </div>\n          </div>\n        </div>\n        <!-- Order Summary Sidebar -->\n        <div class=\"col-lg-4\">\n          <div class=\"order-summary bg-white rounded shadow-sm p-3 mb-4\">\n            <h5 class=\"mb-3\"><i class=\"fas fa-list-alt me-2\"></i>Order Summary</h5>\n            <div v-if=\"cart.cart.items.length\">\n              <div v-for=\"item in cart.cart.items\" :key=\"item.id\" class=\"d-flex align-items-center mb-2\">\n                <div class=\"ms-2 flex-grow-1\">\n                  <div>{{ item.name }}</div>\n                  <div class=\"text-muted\" style=\"font-size:0.95em;\">{{ settings.currency_symbol || '$' }}&nbsp;{{ item.price }} x {{ item.quantity }}</div>\n                </div>\n                <div class=\"fw-bold\">{{ settings.currency_symbol || '$' }}&nbsp;{{ (item.price * item.quantity).toFixed(2) }}</div>\n              </div>\n              <div class=\"border-top pt-2 mt-2\">\n                <div class=\"d-flex justify-content-between\"><span>SubTotal:</span><span>{{ settings.currency_symbol || '$' }}&nbsp;{{ subtotal.toFixed(2) }}</span></div>\n                <div class=\"d-flex justify-content-between\"><span>Discount:</span><span>{{ settings.discount }}%</span></div>\n                <div class=\"d-flex justify-content-between fw-bold\"><span>Grand total:</span><span>{{ settings.currency_symbol || '$' }}&nbsp;{{ grandTotal.toFixed(2) }}</span></div>\n              </div>\n            </div>\n            <div v-else class=\"text-muted text-center py-4\">\n              Your Cart Is Currently Empty!\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, inject, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useCart } from '../../composables/useCart'\nimport axios from 'axios'\nimport Swal from 'sweetalert2'\n\nconst cart = inject('cart', useCart())\nconst router = useRouter()\n\nconst steps = [\n  { key: 'address', title: 'Delivery Address' },\n  { key: 'delivery', title: 'Delivery Method' },\n  { key: 'review', title: 'Order Review' }\n]\nconst currentStep = ref(0)\nconst orderPlaced = ref(false)\n\nconst address = ref({\n  firstName: '', lastName: '', middleName: '', company: '', email: '', phone: '', country: '', city: '', place: '', postalCode: '', address: ''\n})\nconst deliveryMethod = ref('free')\nconst paymentMethod = ref('credit')\nconst payment = ref({ cardName: '', cardNumber: '', expMonth: '', expYear: '', cvv: '' })\n\nconst settings = ref({ currency: 'USD', discount: 0 })\n\nonMounted(async () => {\n  // Try to load from sessionStorage first\n  const cached = sessionStorage.getItem('tenant_settings')\n  if (cached) {\n    try {\n      settings.value = JSON.parse(cached)\n    } catch {}\n  }\n  // Always fetch latest from API\n  try {\n    const response = await axios.get('/tenant/get-tenant-details')\n    if (response.data.success && response.data.data) {\n      // Set both code and symbol from API\n      settings.value.currency_symbol = response.data.data.currency_symbol || '$'\n      settings.value.discount = response.data.data.discount || 0\n      sessionStorage.setItem('tenant_settings', JSON.stringify(settings.value))\n    }\n  } catch {}\n})\n\nconst deliveryMethodLabel = computed(() => {\n  switch (deliveryMethod.value) {\n    case 'free': return 'Free Delivery (0.00, 7-14 days)'\n    case 'standard': return 'Standard Delivery (7.99, 5-7 days)'\n    case 'express': return 'Express Delivery (29.99, 1 day)'\n    default: return ''\n  }\n})\n\nconst subtotal = computed(() => cart.cart.items.reduce((sum, item) => sum + item.price * item.quantity, 0))\nconst discountAmount = computed(() => subtotal.value * (settings.value.discount / 100))\nconst grandTotal = computed(() => subtotal.value - discountAmount.value)\n\nfunction nextStep() {\n  if (currentStep.value < steps.length - 1) currentStep.value++\n}\nfunction prevStep() {\n  if (currentStep.value > 0) currentStep.value--\n}\nasync function placeOrder() {\n  try {\n    // 1. Gather customer info\n    const customer = {\n      name: address.value.firstName + ' ' + (address.value.lastName || ''),\n      email: address.value.email,\n      address: address.value.address,\n      phone: address.value.phone,\n      device_info: navigator.userAgent,\n      status: 'active'\n    };\n    // 2. Gather order info\n    const order = {\n      total_amount: grandTotal.value,\n      status: 'pending',\n      delivery_address: address.value.address,\n      currency_symbol: settings.value.currency_symbol || '$'\n    };\n    // 3. Gather order details\n    const order_details = cart.cart.items.map(item => ({\n      product_id: item.id,\n      quantity: item.quantity,\n      price: item.price\n    }));\n    // 4. Send to API\n    const response = await axios.post('/tenant/save-order', {\n      customer,\n      order,\n      order_details\n    });\n    // 5. Handle response\n    if (response.data.success) {\n      // Show star rating prompt\n      await Swal.fire({\n        title: 'Thank you!',\n        text: 'Please rate your experience.',\n        icon: 'success',\n        html: `<div id='swal-stars' style='font-size:2rem; color: #f6c700; display: flex; justify-content: center;'>\n          <i class='fa fa-star' data-value='1'></i>\n          <i class='fa fa-star' data-value='2'></i>\n          <i class='fa fa-star' data-value='3'></i>\n          <i class='fa fa-star' data-value='4'></i>\n          <i class='fa fa-star' data-value='5'></i>\n        </div>`,\n        showConfirmButton: true,\n        confirmButtonText: 'Submit',\n        didOpen: () => {\n          let selected = 5;\n          const stars = Swal.getHtmlContainer().querySelectorAll('.fa-star');\n          stars.forEach((star, idx) => {\n            star.addEventListener('mouseenter', () => {\n              stars.forEach((s, i) => s.style.color = i <= idx ? '#f6c700' : '#ccc');\n            });\n            star.addEventListener('mouseleave', () => {\n              stars.forEach((s, i) => s.style.color = i < selected ? '#f6c700' : '#ccc');\n            });\n            star.addEventListener('click', () => {\n              selected = idx + 1;\n              stars.forEach((s, i) => s.style.color = i < selected ? '#f6c700' : '#ccc');\n              Swal.setInputValue(selected);\n            });\n          });\n          Swal.setInputValue(selected);\n        },\n        preConfirm: () => {\n          return Swal.getInput().value;\n        },\n        input: 'hidden',\n        inputValue: 5\n      });\n      cart.clearCart();\n      orderPlaced.value = true;\n    } else {\n      throw new Error(response.data.message || 'Order not saved');\n    }\n  } catch (error) {\n    Swal.fire({\n      icon: 'error',\n      title: 'Order Failed',\n      text: error.message || 'Could not save your order. Please try again.'\n    });\n  }\n}\nfunction goToShop() {\n  router.push({ name: 'tenant-landing' })\n}\n</script>\n\n<style scoped>\n.checkout-page {\n  background: #f8f9fa;\n}\n.checkout-steps {\n  display: flex;\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n  flex-wrap: wrap;\n}\n.checkout-step {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  opacity: 0.5;\n  transition: opacity 0.2s;\n  min-width: 100px;\n}\n.checkout-step.active {\n  opacity: 1;\n  font-weight: bold;\n}\n.checkout-step.done {\n  opacity: 0.8;\n}\n.step-index {\n  background: #c62828;\n  color: #fff;\n  border-radius: 50%;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.1rem;\n  margin-bottom: 0.3rem;\n}\n.checkout-step-title {\n  font-size: 1rem;\n}\n.checkout-step-content {\n  min-height: 350px;\n}\n.order-summary {\n  min-width: 260px;\n}\n@media (max-width: 991.98px) {\n  .checkout-page .row {\n    flex-direction: column;\n  }\n  .order-summary {\n    margin-top: 2rem;\n    min-width: 100%;\n  }\n}\n@media (max-width: 767.98px) {\n  .checkout-step {\n    min-width: 80px;\n    font-size: 0.95rem;\n  }\n  .checkout-step-content {\n    padding: 1rem !important;\n  }\n  .order-summary {\n    padding: 1rem !important;\n  }\n}\n</style>\n\n"],"names":["cart","inject","useCart","router","useRouter","steps","currentStep","ref","orderPlaced","address","deliveryMethod","settings","onMounted","cached","response","axios","deliveryMethodLabel","computed","subtotal","sum","item","discountAmount","grandTotal","nextStep","prevStep","placeOrder","customer","order","order_details","Swal","selected","stars","star","idx","s","i","error","goToShop"],"mappings":"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"}