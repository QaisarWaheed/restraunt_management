import{_ as H,L as r,z as L,B as W,C as Y,c as a,a as e,j as R,v as q,f as w,n as x,J as V,F as p,g as _,b as j,t as d,N as Q,S as X,o,P as Z}from"./app-BLvk--SP.js";const ee={class:"Reservations-page"},te={class:"mb-4"},le={class:"filter-body"},se={class:"row g-3 align-items-end flex-nowrap"},ae={class:"col-md-6"},oe={class:"col-md-6 d-flex align-items-end justify-content-end"},ne={class:"dropdown column-filter-dropdown ms-auto"},ie={class:"form-check mb-2"},de=["id","value"],re=["for"],ue={class:"card"},ce={class:"card-body"},ve={key:0,class:"text-center py-5"},me={key:1,class:"text-center py-5 text-muted"},pe={key:2,class:"table-responsive"},_e={class:"table table-hover table-sm Reservations-table"},be={key:0},ye={class:"fw-bold"},fe={class:"small text-muted"},ge={key:1},ke={key:2},he=["onClick"],Ce={key:3,class:"d-flex justify-content-between align-items-center mt-3"},we={class:"text-muted"},xe={key:0},Se={class:"pagination mb-0"},Me=["disabled"],Ae=["onClick"],De=["disabled"],Ne={class:"modal fade",id:"detailsModal",tabindex:"-1"},Re={class:"modal-dialog"},Be={class:"modal-content"},Le={class:"modal-body"},Ve={class:"table table-bordered"},je={key:0},Ee={key:1},E="reservations_selected_columns_v1",Fe={__name:"Reservations",setup(Ie){const b=r([]),S=r(!1),M=r({search:""}),n=r({current_page:1,last_page:1,per_page:8,total:0,from:0,to:0}),c=[{key:"full_name",label:"Name"},{key:"phone_number",label:"Phone"},{key:"guests",label:"Guests"},{key:"email",label:"Email"},{key:"date",label:"Date"},{key:"time",label:"Time"},{key:"message",label:"Message"},{key:"created_at",label:"Created At"}],u=r(["full_name","phone_number","guests"]),y=r(c.filter(s=>u.value.includes(s.key))),f=r(!1),v=r([...u.value]),k=r(!1),F=r(null),I=()=>{f.value=!f.value,v.value=[...u.value],B()},T=()=>{u.value=[...v.value],y.value=c.filter(s=>u.value.includes(s.key)),f.value=!1},O=()=>{v.value=[...u.value],f.value=!1},U=()=>{k.value?v.value=c.map(s=>s.key):v.value=[]},B=()=>{k.value=v.value.length===c.length};L(v,B);const h=r({});let A=null;const $=s=>{h.value=s,A||(A=new Z(document.getElementById("detailsModal"))),A.show()},D=async(s=1)=>{S.value=!0;try{const l={page:s,per_page:n.value.per_page,search:M.value.search},t=await Q.get("/tenant/reservations-list",{params:l});if(t.data.success){const{data:i,current_page:m,last_page:C,per_page:g,total:P,from:K,to:G}=t.data.data;b.value=i,n.value={current_page:m,last_page:C,per_page:g,total:P,from:K,to:G}}else b.value=[],n.value={current_page:1,last_page:1,per_page:8,total:0,from:0,to:0}}catch{b.value=[],X.fire({icon:"error",title:"Error",text:"Failed to fetch reservations."})}finally{S.value=!1}},z=()=>{D(1)},N=s=>{s<1||s>n.value.last_page||D(s)},J=W(()=>{const s=n.value.last_page,l=n.value.current_page,t=5;let i=Math.max(1,l-2),m=Math.min(s,l+2);m-i<t-1&&(i===1?m=Math.min(s,i+t-1):m===s&&(i=Math.max(1,m-t+1)));const C=[];for(let g=i;g<=m;g++)C.push(g);return C});return Y(()=>{const s=localStorage.getItem(E);if(s)try{const l=JSON.parse(s);Array.isArray(l)&&l.every(t=>c.some(i=>i.key===t))&&(u.value=l,y.value=c.filter(t=>u.value.includes(t.key)))}catch{}D(),y.value=c.filter(l=>u.value.includes(l.key))}),L(u,s=>{localStorage.setItem(E,JSON.stringify(s))}),(s,l)=>(o(),a("div",ee,[l[14]||(l[14]=e("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e("h4",{class:"mb-0"},"Reservations List")],-1)),e("div",te,[e("div",le,[e("div",se,[e("div",ae,[l[5]||(l[5]=e("label",{class:"form-label mb-1"},"Search",-1)),R(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>M.value.search=t),onInput:z,type:"text",class:"form-control filter-input",placeholder:"Search by name, email, phone, date, or message"},null,544),[[q,M.value.search]])]),e("div",oe,[e("div",ne,[e("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button",onClick:I,ref_key:"dropdownBtn",ref:F},l[6]||(l[6]=[e("i",{class:"fas fa-filter me-1"},null,-1),w(" Columns ")]),512),e("div",{class:x(["dropdown-menu p-3",{show:f.value}]),style:{"min-width":"260px","max-height":"320px","overflow-y":"auto"}},[e("div",ie,[R(e("input",{class:"form-check-input",type:"checkbox",id:"selectAllCols","onUpdate:modelValue":l[1]||(l[1]=t=>k.value=t),onChange:U},null,544),[[V,k.value]]),l[7]||(l[7]=e("label",{class:"form-check-label",for:"selectAllCols"},"(Select All)",-1))]),(o(),a(p,null,_(c,t=>e("div",{key:t.key,class:"form-check mb-1"},[R(e("input",{class:"form-check-input",type:"checkbox",id:"col-"+t.key,"onUpdate:modelValue":l[2]||(l[2]=i=>v.value=i),value:t.key},null,8,de),[[V,v.value]]),e("label",{class:"form-check-label",for:"col-"+t.key},d(t.label),9,re)])),64)),e("div",{class:"d-flex justify-content-end gap-2 mt-3"},[e("button",{class:"btn btn-sm btn-primary",onClick:T},"OK"),e("button",{class:"btn btn-sm btn-secondary",onClick:O},"Cancel")])],2)])])])])]),e("div",ue,[e("div",ce,[S.value?(o(),a("div",ve,l[8]||(l[8]=[e("div",{class:"spinner-border text-danger",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):b.value.length===0?(o(),a("div",me,l[9]||(l[9]=[e("i",{class:"fas fa-store fa-3x mb-3",style:{color:"#bdbdbd"}},null,-1),e("div",{class:"h5 mb-2"},"No Reservations Found",-1),e("div",null,[w("No reservations match your search criteria."),e("br"),w("Try adjusting your filters.")],-1)]))):(o(),a("div",pe,[e("table",_e,[e("thead",null,[e("tr",null,[(o(!0),a(p,null,_(y.value,t=>(o(),a("th",{key:t.key},d(t.label),1))),128)),l[10]||(l[10]=e("th",null,"Action",-1))])]),e("tbody",null,[(o(!0),a(p,null,_(b.value,t=>(o(),a("tr",{key:t.id},[(o(!0),a(p,null,_(y.value,i=>(o(),a("td",{key:i.key},[i.key==="full_name"?(o(),a("div",be,[e("div",ye,d(t.full_name),1),e("div",fe,d(t.email),1)])):i.key==="created_at"?(o(),a("span",ge,d(t.created_at?new Date(t.created_at).toLocaleString():""),1)):(o(),a("span",ke,d(t[i.key]),1))]))),128)),e("td",null,[e("button",{class:"btn btn-sm btn-primary",onClick:i=>$(t)},l[11]||(l[11]=[e("i",{class:"fas fa-eye"},null,-1),w(" View Details")]),8,he)])]))),128))])])])),n.value.total>0?(o(),a("div",Ce,[e("div",we," Showing "+d(n.value.from)+" to "+d(n.value.to)+" of "+d(n.value.total)+" entries ",1),n.value.last_page>1?(o(),a("nav",xe,[e("ul",Se,[e("li",{class:x(["page-item",{disabled:n.value.current_page===1}])},[e("button",{class:"page-link",onClick:l[3]||(l[3]=t=>N(n.value.current_page-1)),disabled:n.value.current_page===1},"«",8,Me)],2),(o(!0),a(p,null,_(J.value,t=>(o(),a("li",{key:t,class:x(["page-item",{active:t===n.value.current_page}])},[e("button",{class:"page-link",onClick:i=>N(t)},d(t),9,Ae)],2))),128)),e("li",{class:x(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("button",{class:"page-link",onClick:l[4]||(l[4]=t=>N(n.value.current_page+1)),disabled:n.value.current_page===n.value.last_page},"»",8,De)],2)])])):j("",!0)])):j("",!0)])]),e("div",Ne,[e("div",Re,[e("div",Be,[l[12]||(l[12]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Reservation Details"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Le,[e("table",Ve,[e("tbody",null,[(o(),a(p,null,_(c,t=>e("tr",{key:t.key},[e("th",null,d(t.label),1),e("td",null,[t.key==="created_at"&&h.value.created_at?(o(),a("span",je,d(new Date(h.value.created_at).toLocaleString()),1)):(o(),a("span",Ee,d(h.value[t.key]),1))])])),64))])])]),l[13]||(l[13]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])])]))}},Oe=H(Fe,[["__scopeId","data-v-d8f5e903"]]);export{Oe as default};
//# sourceMappingURL=Reservations-BF5SgpWS.js.map
