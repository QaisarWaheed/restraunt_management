{"version":3,"file":"ContactRequests-MraHn7iL.js","sources":["../../../resources/js/views/tenant_dashboard/ContactRequests.vue"],"sourcesContent":["<template>\n  <div class=\"Reservations-page\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n      <h4 class=\"mb-0\">Contact Requests</h4>\n    </div>\n    <!-- Filters and Column Filter -->\n    <div class=\"mb-4\">\n      <div class=\"filter-body\">\n        <div class=\"row g-3 align-items-end flex-nowrap\">\n          <div class=\"col-md-6\">\n            <label class=\"form-label mb-1\">Search</label>\n            <input v-model=\"filters.search\" @input=\"applyFilters\" type=\"text\" class=\"form-control filter-input\" placeholder=\"Search by name, email, phone, subject, or message\">\n          </div>\n          <div class=\"col-md-6 d-flex align-items-end justify-content-end\">\n            <!-- Column Filter Dropdown -->\n            <div class=\"dropdown column-filter-dropdown ms-auto\">\n              <button class=\"btn btn-outline-secondary dropdown-toggle\" type=\"button\" @click=\"toggleColumnDropdown\" ref=\"dropdownBtn\">\n                <i class=\"fas fa-filter me-1\"></i> Columns\n              </button>\n              <div class=\"dropdown-menu p-3\" :class=\"{ show: showColumnDropdown }\" style=\"min-width: 260px; max-height: 320px; overflow-y: auto;\">\n                <div class=\"form-check mb-2\">\n                  <input class=\"form-check-input\" type=\"checkbox\" id=\"selectAllCols\" v-model=\"selectAllChecked\" @change=\"toggleSelectAll\">\n                  <label class=\"form-check-label\" for=\"selectAllCols\">(Select All)</label>\n                </div>\n                <div v-for=\"col in allColumns\" :key=\"col.key\" class=\"form-check mb-1\">\n                  <input class=\"form-check-input\" type=\"checkbox\" :id=\"'col-' + col.key\" v-model=\"tempSelectedColumns\" :value=\"col.key\">\n                  <label class=\"form-check-label\" :for=\"'col-' + col.key\">{{ col.label }}</label>\n                </div>\n                <div class=\"d-flex justify-content-end gap-2 mt-3\">\n                  <button class=\"btn btn-sm btn-primary\" @click=\"applyColumnSelection\">OK</button>\n                  <button class=\"btn btn-sm btn-secondary\" @click=\"cancelColumnSelection\">Cancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- Contact Requests Table -->\n    <div class=\"card\">\n      <div class=\"card-body\">\n        <div v-if=\"loading\" class=\"text-center py-5\">\n          <div class=\"spinner-border text-danger\" role=\"status\"><span class=\"visually-hidden\">Loading...</span></div>\n        </div>\n        <div v-else-if=\"contacts.length === 0\" class=\"text-center py-5 text-muted\">\n          <i class=\"fas fa-store fa-3x mb-3\" style=\"color: #bdbdbd;\"></i>\n          <div class=\"h5 mb-2\">No Contact Requests Found</div>\n          <div>No contact requests match your search criteria.<br>Try adjusting your filters.</div>\n        </div>\n        <div v-else class=\"table-responsive\">\n          <table class=\"table table-hover table-sm Reservations-table\">\n            <thead>\n              <tr>\n                <th v-for=\"col in visibleColumns\" :key=\"col.key\">{{ col.label }}</th>\n                <th>Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"contact in contacts\" :key=\"contact.id\">\n                <td v-for=\"col in visibleColumns\" :key=\"col.key\">\n                  <template v-if=\"col.key === 'name'\">\n                    <div class=\"fw-bold\">{{ contact.name }}</div>\n                    <div class=\"small text-muted d-flex align-items-center\">\n                      <span>{{ contact.email }}</span>\n                      <button class=\"btn btn-link btn-copy p-0 ms-1\" @click=\"copyToClipboard(contact.email, 'Email')\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"Copy Email\">\n                        <i class=\"fas fa-copy\"></i>\n                      </button>\n                    </div>\n                  </template>\n                  <template v-else-if=\"col.key === 'phone'\">\n                    <span>{{ contact.phone }}</span>\n                    <button class=\"btn btn-link btn-copy p-0 ms-2\" @click=\"copyToClipboard(contact.phone, 'Phone')\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"Copy Phone\">\n                      <i class=\"fas fa-copy\"></i>\n                    </button>\n                  </template>\n                  <template v-else-if=\"col.key === 'message'\">\n                    <span :title=\"contact.message\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\">\n                      {{ contact.message.length > 18 ? contact.message.slice(0, 18) + '...' : contact.message }}\n                    </span>\n                  </template>\n                  <template v-else-if=\"col.key === 'created_at'\">\n                    {{ contact.created_at ? new Date(contact.created_at).toLocaleString() : '' }}\n                  </template>\n                  <template v-else>\n                    {{ contact[col.key] }}\n                  </template>\n                </td>\n                <td>\n                  <button class=\"btn btn-sm btn-primary\" @click=\"showDetails(contact)\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"View Details\"><i class=\"fas fa-eye\"></i> View</button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <!-- Pagination -->\n        <div v-if=\"pagination.total > 0\" class=\"d-flex justify-content-between align-items-center mt-3\">\n          <div class=\"text-muted\">\n            Showing {{ pagination.from }} to {{ pagination.to }} of {{ pagination.total }} entries\n          </div>\n          <nav v-if=\"pagination.last_page > 1\">\n            <ul class=\"pagination mb-0\">\n              <li class=\"page-item\" :class=\"{ disabled: pagination.current_page === 1 }\">\n                <button class=\"page-link\" @click=\"goToPage(pagination.current_page - 1)\" :disabled=\"pagination.current_page === 1\">&laquo;</button>\n              </li>\n              <li v-for=\"page in paginationWindow\" :key=\"page\" class=\"page-item\" :class=\"{ active: page === pagination.current_page }\">\n                <button class=\"page-link\" @click=\"goToPage(page)\">{{ page }}</button>\n              </li>\n              <li class=\"page-item\" :class=\"{ disabled: pagination.current_page === pagination.last_page }\">\n                <button class=\"page-link\" @click=\"goToPage(pagination.current_page + 1)\" :disabled=\"pagination.current_page === pagination.last_page\">&raquo;</button>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </div>\n    </div>\n    <!-- Details Modal -->\n    <div class=\"modal fade\" id=\"detailsModal\" tabindex=\"-1\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">Contact Request Details</h5>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <table class=\"table table-bordered\">\n              <tbody>\n                <tr v-for=\"col in allColumns\" :key=\"col.key\">\n                  <th>{{ col.label }}</th>\n                  <td>\n                    <span v-if=\"col.key === 'created_at' && selectedContact.created_at\">\n                      {{ new Date(selectedContact.created_at).toLocaleString() }}\n                    </span>\n                    <span v-else>\n                      {{ selectedContact[col.key] }}\n                    </span>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, watch } from 'vue'\nimport axios from 'axios'\nimport Swal from 'sweetalert2'\nimport { Modal, Tooltip } from 'bootstrap'\n\nconst contacts = ref([])\nconst loading = ref(false)\nconst filters = ref({ search: '' })\nconst pagination = ref({\n  current_page: 1,\n  last_page: 1,\n  per_page: 8,\n  total: 0,\n  from: 0,\n  to: 0\n})\n\nconst allColumns = [\n  { key: 'name', label: 'Name' },\n  { key: 'email', label: 'Email' },\n  { key: 'phone', label: 'Phone' },\n  { key: 'subject', label: 'Subject' },\n  { key: 'message', label: 'Message' },\n  { key: 'created_at', label: 'Created At' },\n]\nconst COLUMN_CACHE_KEY = 'contactreqs_selected_columns_v1';\nconst selectedColumns = ref(['name', 'subject', 'message'])\nconst visibleColumns = ref(allColumns.filter(col => selectedColumns.value.includes(col.key)))\n\n// Column filter dropdown logic\nconst showColumnDropdown = ref(false)\nconst tempSelectedColumns = ref([...selectedColumns.value])\nconst selectAllChecked = ref(false)\nconst dropdownBtn = ref(null)\n\nconst toggleColumnDropdown = () => {\n  showColumnDropdown.value = !showColumnDropdown.value\n  tempSelectedColumns.value = [...selectedColumns.value]\n  updateSelectAllChecked()\n}\nconst applyColumnSelection = () => {\n  selectedColumns.value = [...tempSelectedColumns.value]\n  visibleColumns.value = allColumns.filter(col => selectedColumns.value.includes(col.key))\n  showColumnDropdown.value = false\n}\nconst cancelColumnSelection = () => {\n  tempSelectedColumns.value = [...selectedColumns.value]\n  showColumnDropdown.value = false\n}\nconst toggleSelectAll = () => {\n  if (selectAllChecked.value) {\n    tempSelectedColumns.value = allColumns.map(col => col.key)\n  } else {\n    tempSelectedColumns.value = []\n  }\n}\nconst updateSelectAllChecked = () => {\n  selectAllChecked.value = tempSelectedColumns.value.length === allColumns.length\n}\nwatch(tempSelectedColumns, updateSelectAllChecked)\n\nconst selectedContact = ref({})\nlet detailsModal = null\nconst showDetails = (contact) => {\n  selectedContact.value = contact\n  if (!detailsModal) {\n    detailsModal = new Modal(document.getElementById('detailsModal'))\n  }\n  detailsModal.show()\n}\n\nconst copyToClipboard = (value, label) => {\n  navigator.clipboard.writeText(value)\n    .then(() => {\n      Swal.fire({\n        icon: 'success',\n        title: 'Copied!',\n        text: `${label} copied to clipboard.`,\n        toast: true,\n        position: 'top-end',\n        showConfirmButton: false,\n        timer: 1200\n      })\n    })\n    .catch(() => {\n      Swal.fire({\n        icon: 'error',\n        title: 'Error',\n        text: `Failed to copy ${label.toLowerCase()}.`\n      })\n    })\n}\n\nconst fetchContacts = async (page = 1) => {\n  loading.value = true\n  try {\n    const params = {\n      page,\n      per_page: pagination.value.per_page,\n      search: filters.value.search\n    }\n    const response = await axios.get('/tenant/contacts-list', { params })\n    if (response.data.success) {\n      const { data, current_page, last_page, per_page, total, from, to } = response.data.data\n      contacts.value = data\n      pagination.value = { current_page, last_page, per_page, total, from, to }\n    } else {\n      contacts.value = []\n      pagination.value = { current_page: 1, last_page: 1, per_page: 8, total: 0, from: 0, to: 0 }\n    }\n  } catch (error) {\n    contacts.value = []\n    Swal.fire({ icon: 'error', title: 'Error', text: 'Failed to fetch contact requests.' })\n  } finally {\n    loading.value = false\n  }\n}\n\nconst applyFilters = () => {\n  fetchContacts(1)\n}\n\nconst goToPage = (page) => {\n  if (page < 1 || page > pagination.value.last_page) return\n  fetchContacts(page)\n}\n\n// Pagination window logic\nconst paginationWindow = computed(() => {\n  const total = pagination.value.last_page\n  const current = pagination.value.current_page\n  const windowSize = 5\n  let start = Math.max(1, current - 2)\n  let end = Math.min(total, current + 2)\n  if (end - start < windowSize - 1) {\n    if (start === 1) {\n      end = Math.min(total, start + windowSize - 1)\n    } else if (end === total) {\n      start = Math.max(1, end - windowSize + 1)\n    }\n  }\n  const pages = []\n  for (let i = start; i <= end; i++) pages.push(i)\n  return pages\n})\n\n// Load from localStorage on mount\nonMounted(() => {\n  const cached = localStorage.getItem(COLUMN_CACHE_KEY)\n  if (cached) {\n    try {\n      const parsed = JSON.parse(cached)\n      if (Array.isArray(parsed) && parsed.every(k => allColumns.some(c => c.key === k))) {\n        selectedColumns.value = parsed\n        visibleColumns.value = allColumns.filter(col => selectedColumns.value.includes(col.key))\n      }\n    } catch {}\n  }\n  fetchContacts()\n  setTimeout(() => {\n    document.querySelectorAll('[data-bs-toggle=\"tooltip\"]').forEach(el => {\n      new Tooltip(el)\n    })\n  }, 500)\n})\n\n// Save to localStorage on change\nwatch(selectedColumns, (val) => {\n  localStorage.setItem(COLUMN_CACHE_KEY, JSON.stringify(val))\n})\n</script>\n\n<style scoped>\n.Reservations-page {\n  padding: 20px;\n  font-family: 'Inter', 'Roboto', 'Segoe UI', Arial, sans-serif;\n  font-size: 16px;\n}\n.filter-body {\n  padding: 0;\n}\n.filter-input {\n  border-radius: 8px;\n  font-size: 15px;\n  border: 1px solid #e0e0e0;\n  background: #fafbfc;\n}\n.Reservations-table {\n  border: 1px solid #e0e0e0;\n  box-shadow: 0 2px 8px rgba(60,60,60,0.06);\n  font-size: 15px;\n  border-radius: 8px;\n  overflow: hidden;\n}\n.Reservations-table thead th {\n  background: #fafbfc;\n  position: sticky;\n  top: 0;\n  z-index: 2;\n  font-weight: 500;\n  color: #b71c1c;\n}\n.Reservations-table tbody tr:nth-child(even) {\n  background: #f7f7f7;\n}\n.Reservations-table tbody tr:hover {\n  background: #fff3f3;\n}\n.pagination .page-link {\n  color: #6c757d;\n  border: none;\n  background-color: transparent;\n  border-radius: 0.25rem;\n  margin: 0 2px;\n  padding: 0.5rem 0.75rem;\n}\n.pagination .page-item.active .page-link {\n  background-color: #c62828;\n  color: #fff;\n  z-index: 3;\n}\n.pagination .page-item.disabled .page-link {\n  color: #ced4da;\n}\n.pagination .page-link:hover {\n  background-color: #f1f1f1;\n}\n.column-filter-dropdown {\n  position: relative;\n}\n.column-filter-dropdown .dropdown-menu {\n  left: auto;\n  right: 0;\n  min-width: 260px;\n  box-shadow: 0 4px 24px rgba(60,60,60,0.13);\n  border-radius: 8px;\n  border: 1px solid #e0e0e0;\n  z-index: 1052;\n}\n.column-filter-dropdown .form-check {\n  user-select: none;\n}\n.fw-bold {\n  font-weight: 600 !important;\n}\n.btn-copy {\n  color: #b71c1c;\n  font-size: 1rem;\n  vertical-align: middle;\n  background: none;\n  border: none;\n  cursor: pointer;\n  transition: color 0.2s;\n}\n.btn-copy:hover {\n  color: #c62828;\n}\n.table td {\n  vertical-align: middle;\n}\n</style>"],"names":["COLUMN_CACHE_KEY","contacts","ref","loading","filters","pagination","allColumns","selectedColumns","visibleColumns","col","showColumnDropdown","tempSelectedColumns","selectAllChecked","dropdownBtn","toggleColumnDropdown","updateSelectAllChecked","applyColumnSelection","cancelColumnSelection","toggleSelectAll","watch","selectedContact","detailsModal","showDetails","contact","Modal","copyToClipboard","value","label","Swal","fetchContacts","page","params","response","axios","data","current_page","last_page","per_page","total","from","to","applyFilters","goToPage","paginationWindow","computed","current","windowSize","start","end","pages","i","onMounted","cached","parsed","k","c","el","Tooltip","val"],"mappings":"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"}