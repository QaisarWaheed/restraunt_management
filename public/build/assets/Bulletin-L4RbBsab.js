import{_ as x,c as u,a as s,i as w,j as E,f as _,v as S,b as D,L as m,C as B,T as C,N as p,S as l,o as f}from"./app-BLvk--SP.js";const F={name:"Settings",setup(){const g=m(!0),t=m(!1),y=m(null),n=[{name:"USD",symbol:"$"},{name:"EUR",symbol:"€"},{name:"GBP",symbol:"£"},{name:"INR",symbol:"₹"},{name:"CAD",symbol:"C$"},{name:"AUD",symbol:"A$"},{name:"JPY",symbol:"¥"}],r=m({discount:""}),b=async e=>{var d,v;const o=e.target.files[0];if(!o)return;if(o.size>2*1024*1024){l.fire({icon:"error",title:"Error",text:"Logo file size must be less than 2MB"});return}if(!o.type.startsWith("image/")){l.fire({icon:"error",title:"Error",text:"Please upload an image file"});return}const a=new FormData;a.append("logo",o);try{const i=await p.post("/tenant/upload-logo",a,{headers:{"Content-Type":"multipart/form-data"}});if(i.data.success)r.value.logo=i.data.url;else throw new Error(i.data.message||"Failed to upload logo")}catch(i){console.error("Error uploading logo:",i),l.fire({icon:"error",title:"Error",text:((v=(d=i.response)==null?void 0:d.data)==null?void 0:v.message)||"Failed to upload logo"})}},c=async()=>{try{const e=await p.get("/tenant/settings");if(e.data.success&&e.data.data){const o=e.data.data;if(r.value={discount:o.discount||""},o.currency_symbol){const a=n.find(d=>d.symbol===o.currency_symbol);a&&(r.value.currency_symbol=a.symbol)}}}catch(e){console.error("Error fetching settings:",e),l.fire({icon:"error",title:"Error",text:"Failed to fetch settings"})}finally{g.value=!1}},h=async()=>{var e,o;t.value=!0;try{const a=await p.put("/tenant/settings/discount",{discount:r.value.discount});if(a.data.success)l.fire({icon:"success",title:"Success",text:"Discount updated successfully",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});else throw new Error(a.data.message||"Failed to save discount")}catch(a){console.error("Error saving discount:",a),l.fire({icon:"error",title:"Error",text:((o=(e=a.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to save discount"})}finally{t.value=!1}};return B(()=>{Promise.all([c()]).then(()=>{}),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(e=>{new C(e)})}),{form:r,loading:g,saving:t,logoInput:y,staticCurrencies:n,handleLogoUpload:b,saveSettings:h}}},N={class:"settings-page"},k={class:"card"},T={class:"card-body"},U={key:0,class:"text-center py-5"},A={class:"section mb-4"},L={class:"row g-3"},M={class:"col-md-6"},P={class:"text-end"},V=["disabled"],I={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"};function j(g,t,y,n,r,b){return f(),u("div",N,[t[6]||(t[6]=s("div",{class:"d-flex justify-content-between align-items-center mb-4"},[s("h4",{class:"mb-0"},"Bulliten Board")],-1)),s("div",k,[s("div",T,[n.loading?(f(),u("div",U,t[2]||(t[2]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):(f(),u("form",{key:1,onSubmit:t[1]||(t[1]=w((...c)=>n.saveSettings&&n.saveSettings(...c),["prevent"])),class:"settings-form"},[s("div",A,[t[4]||(t[4]=s("h5",{class:"section-title"},"Discount News",-1)),s("div",L,[s("div",M,[t[3]||(t[3]=s("label",{class:"form-label"},[_("Discount (in %) "),s("span",{class:"ms-1","data-bs-toggle":"tooltip",title:"Enter your discount percentage."},[s("i",{class:"fas fa-info-circle text-secondary"})])],-1)),E(s("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>n.form.discount=c),type:"number",min:"0",max:"100",class:"form-control",required:"",placeholder:"Discount %"},null,512),[[S,n.form.discount]])])])]),s("div",P,[s("button",{type:"submit",class:"btn btn-primary",disabled:n.saving},[n.saving?(f(),u("span",I)):D("",!0),t[5]||(t[5]=_(" Save Discount "))],8,V)])],32))])])])}const z=x(F,[["render",j],["__scopeId","data-v-677b3b9a"]]);export{z as default};
//# sourceMappingURL=Bulletin-L4RbBsab.js.map
