{"version":3,"file":"Reservations-BF5SgpWS.js","sources":["../../../resources/js/views/tenant_dashboard/Reservations.vue"],"sourcesContent":["<template>\n  <div class=\"Reservations-page\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n      <h4 class=\"mb-0\">Reservations List</h4>\n    </div>\n    <!-- Filters Row -->\n    <div class=\"mb-4\">\n      <div class=\"filter-body\">\n        <div class=\"row g-3 align-items-end flex-nowrap\">\n          <div class=\"col-md-6\">\n            <label class=\"form-label mb-1\">Search</label>\n            <input v-model=\"filters.search\" @input=\"applyFilters\" type=\"text\" class=\"form-control filter-input\" placeholder=\"Search by name, email, phone, date, or message\">\n          </div>\n          <div class=\"col-md-6 d-flex align-items-end justify-content-end\">\n            <!-- Column Filter Dropdown -->\n            <div class=\"dropdown column-filter-dropdown ms-auto\">\n              <button class=\"btn btn-outline-secondary dropdown-toggle\" type=\"button\" @click=\"toggleColumnDropdown\" ref=\"dropdownBtn\">\n                <i class=\"fas fa-filter me-1\"></i> Columns\n              </button>\n              <div class=\"dropdown-menu p-3\" :class=\"{ show: showColumnDropdown }\" style=\"min-width: 260px; max-height: 320px; overflow-y: auto;\">\n                <div class=\"form-check mb-2\">\n                  <input class=\"form-check-input\" type=\"checkbox\" id=\"selectAllCols\" v-model=\"selectAllChecked\" @change=\"toggleSelectAll\">\n                  <label class=\"form-check-label\" for=\"selectAllCols\">(Select All)</label>\n                </div>\n                <div v-for=\"col in allColumns\" :key=\"col.key\" class=\"form-check mb-1\">\n                  <input class=\"form-check-input\" type=\"checkbox\" :id=\"'col-' + col.key\" v-model=\"tempSelectedColumns\" :value=\"col.key\">\n                  <label class=\"form-check-label\" :for=\"'col-' + col.key\">{{ col.label }}</label>\n                </div>\n                <div class=\"d-flex justify-content-end gap-2 mt-3\">\n                  <button class=\"btn btn-sm btn-primary\" @click=\"applyColumnSelection\">OK</button>\n                  <button class=\"btn btn-sm btn-secondary\" @click=\"cancelColumnSelection\">Cancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- Reservations Table -->\n    <div class=\"card\">\n      <div class=\"card-body\">\n        <div v-if=\"loading\" class=\"text-center py-5\">\n          <div class=\"spinner-border text-danger\" role=\"status\"><span class=\"visually-hidden\">Loading...</span></div>\n        </div>\n        <div v-else-if=\"reservations.length === 0\" class=\"text-center py-5 text-muted\">\n          <i class=\"fas fa-store fa-3x mb-3\" style=\"color: #bdbdbd;\"></i>\n          <div class=\"h5 mb-2\">No Reservations Found</div>\n          <div>No reservations match your search criteria.<br>Try adjusting your filters.</div>\n        </div>\n        <div v-else class=\"table-responsive\">\n          <table class=\"table table-hover table-sm Reservations-table\">\n            <thead>\n              <tr>\n                <th v-for=\"col in visibleColumns\" :key=\"col.key\">{{ col.label }}</th>\n                <th>Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"reservation in reservations\" :key=\"reservation.id\">\n                <td v-for=\"col in visibleColumns\" :key=\"col.key\">\n                  <div v-if=\"col.key === 'full_name'\">\n                    <div class=\"fw-bold\">{{ reservation.full_name }}</div>\n                    <div class=\"small text-muted\">{{ reservation.email }}</div>\n                  </div>\n                  <span v-else-if=\"col.key === 'created_at'\">\n                    {{ reservation.created_at ? new Date(reservation.created_at).toLocaleString() : '' }}\n                  </span>\n                  <span v-else>\n                    {{ reservation[col.key] }}\n                  </span>\n                </td>\n                <td>\n                  <button class=\"btn btn-sm btn-primary\" @click=\"showDetails(reservation)\"><i class=\"fas fa-eye\"></i> View Details</button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <!-- Pagination -->\n        <div v-if=\"pagination.total > 0\" class=\"d-flex justify-content-between align-items-center mt-3\">\n          <div class=\"text-muted\">\n            Showing {{ pagination.from }} to {{ pagination.to }} of {{ pagination.total }} entries\n          </div>\n          <nav v-if=\"pagination.last_page > 1\">\n            <ul class=\"pagination mb-0\">\n              <li class=\"page-item\" :class=\"{ disabled: pagination.current_page === 1 }\">\n                <button class=\"page-link\" @click=\"goToPage(pagination.current_page - 1)\" :disabled=\"pagination.current_page === 1\">&laquo;</button>\n              </li>\n              <li v-for=\"page in paginationWindow\" :key=\"page\" class=\"page-item\" :class=\"{ active: page === pagination.current_page }\">\n                <button class=\"page-link\" @click=\"goToPage(page)\">{{ page }}</button>\n              </li>\n              <li class=\"page-item\" :class=\"{ disabled: pagination.current_page === pagination.last_page }\">\n                <button class=\"page-link\" @click=\"goToPage(pagination.current_page + 1)\" :disabled=\"pagination.current_page === pagination.last_page\">&raquo;</button>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </div>\n    </div>\n    <!-- Details Modal -->\n    <div class=\"modal fade\" id=\"detailsModal\" tabindex=\"-1\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">Reservation Details</h5>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <table class=\"table table-bordered\">\n              <tbody>\n                <tr v-for=\"col in allColumns\" :key=\"col.key\">\n                  <th>{{ col.label }}</th>\n                  <td>\n                    <span v-if=\"col.key === 'created_at' && selectedReservation.created_at\">\n                      {{ new Date(selectedReservation.created_at).toLocaleString() }}\n                    </span>\n                    <span v-else>\n                      {{ selectedReservation[col.key] }}\n                    </span>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch, computed } from 'vue'\nimport axios from 'axios'\nimport Swal from 'sweetalert2'\nimport { Modal } from 'bootstrap'\n\nconst reservations = ref([])\nconst loading = ref(false)\nconst filters = ref({ search: '' })\nconst pagination = ref({\n  current_page: 1,\n  last_page: 1,\n  per_page: 8,\n  total: 0,\n  from: 0,\n  to: 0\n})\n\nconst allColumns = [\n  { key: 'full_name', label: 'Name' },\n  { key: 'phone_number', label: 'Phone' },\n  { key: 'guests', label: 'Guests' },\n  { key: 'email', label: 'Email' },\n  { key: 'date', label: 'Date' },\n  { key: 'time', label: 'Time' },\n  { key: 'message', label: 'Message' },\n  { key: 'created_at', label: 'Created At' },\n]\nconst COLUMN_CACHE_KEY = 'reservations_selected_columns_v1';\nconst selectedColumns = ref(['full_name', 'phone_number', 'guests'])\nconst visibleColumns = ref(allColumns.filter(col => selectedColumns.value.includes(col.key)))\n\n// Column filter dropdown logic\nconst showColumnDropdown = ref(false)\nconst tempSelectedColumns = ref([...selectedColumns.value])\nconst selectAllChecked = ref(false)\nconst dropdownBtn = ref(null)\n\nconst toggleColumnDropdown = () => {\n  showColumnDropdown.value = !showColumnDropdown.value\n  tempSelectedColumns.value = [...selectedColumns.value]\n  updateSelectAllChecked()\n}\nconst applyColumnSelection = () => {\n  selectedColumns.value = [...tempSelectedColumns.value]\n  visibleColumns.value = allColumns.filter(col => selectedColumns.value.includes(col.key))\n  showColumnDropdown.value = false\n}\nconst cancelColumnSelection = () => {\n  tempSelectedColumns.value = [...selectedColumns.value]\n  showColumnDropdown.value = false\n}\nconst toggleSelectAll = () => {\n  if (selectAllChecked.value) {\n    tempSelectedColumns.value = allColumns.map(col => col.key)\n  } else {\n    tempSelectedColumns.value = []\n  }\n}\nconst updateSelectAllChecked = () => {\n  selectAllChecked.value = tempSelectedColumns.value.length === allColumns.length\n}\nwatch(tempSelectedColumns, updateSelectAllChecked)\n\nconst selectedReservation = ref({})\nlet detailsModal = null\nconst showDetails = (reservation) => {\n  selectedReservation.value = reservation\n  if (!detailsModal) {\n    detailsModal = new Modal(document.getElementById('detailsModal'))\n  }\n  detailsModal.show()\n}\n\nconst fetchReservations = async (page = 1) => {\n  loading.value = true\n  try {\n    const params = {\n      page,\n      per_page: pagination.value.per_page,\n      search: filters.value.search\n    }\n    const response = await axios.get('/tenant/reservations-list', { params })\n    if (response.data.success) {\n      const { data, current_page, last_page, per_page, total, from, to } = response.data.data\n      reservations.value = data\n      pagination.value = { current_page, last_page, per_page, total, from, to }\n    } else {\n      reservations.value = []\n      pagination.value = { current_page: 1, last_page: 1, per_page: 8, total: 0, from: 0, to: 0 }\n    }\n  } catch (error) {\n    reservations.value = []\n    Swal.fire({ icon: 'error', title: 'Error', text: 'Failed to fetch reservations.' })\n  } finally {\n    loading.value = false\n  }\n}\n\nconst applyFilters = () => {\n  fetchReservations(1)\n}\n\nconst goToPage = (page) => {\n  if (page < 1 || page > pagination.value.last_page) return\n  fetchReservations(page)\n}\n\n// Pagination window logic\nconst paginationWindow = computed(() => {\n  const total = pagination.value.last_page\n  const current = pagination.value.current_page\n  const windowSize = 5\n  let start = Math.max(1, current - 2)\n  let end = Math.min(total, current + 2)\n  if (end - start < windowSize - 1) {\n    if (start === 1) {\n      end = Math.min(total, start + windowSize - 1)\n    } else if (end === total) {\n      start = Math.max(1, end - windowSize + 1)\n    }\n  }\n  const pages = []\n  for (let i = start; i <= end; i++) pages.push(i)\n  return pages\n})\n\n// Load from localStorage on mount\nonMounted(() => {\n  const cached = localStorage.getItem(COLUMN_CACHE_KEY)\n  if (cached) {\n    try {\n      const parsed = JSON.parse(cached)\n      if (Array.isArray(parsed) && parsed.every(k => allColumns.some(c => c.key === k))) {\n        selectedColumns.value = parsed\n        visibleColumns.value = allColumns.filter(col => selectedColumns.value.includes(col.key))\n      }\n    } catch {}\n  }\n  fetchReservations()\n  visibleColumns.value = allColumns.filter(col => selectedColumns.value.includes(col.key))\n})\n\n// Save to localStorage on change\nwatch(selectedColumns, (val) => {\n  localStorage.setItem(COLUMN_CACHE_KEY, JSON.stringify(val))\n})\n</script>\n\n<style scoped>\n.Reservations-page {\n  padding: 20px;\n  font-family: 'Inter', 'Roboto', 'Segoe UI', Arial, sans-serif;\n  font-size: 16px;\n}\n.filter-body {\n  padding: 0;\n}\n.filter-input {\n  border-radius: 8px;\n  font-size: 15px;\n  border: 1px solid #e0e0e0;\n  background: #fafbfc;\n}\n.Reservations-table {\n  border: 1px solid #e0e0e0;\n  box-shadow: 0 2px 8px rgba(60,60,60,0.06);\n  font-size: 15px;\n  border-radius: 8px;\n  overflow: hidden;\n}\n.Reservations-table thead th {\n  background: #fafbfc;\n  position: sticky;\n  top: 0;\n  z-index: 2;\n  font-weight: 500;\n  color: #b71c1c;\n}\n.Reservations-table tbody tr:nth-child(even) {\n  background: #f7f7f7;\n}\n.Reservations-table tbody tr:hover {\n  background: #fff3f3;\n}\n.pagination .page-link {\n  color: #6c757d;\n  border: none;\n  background-color: transparent;\n  border-radius: 0.25rem;\n  margin: 0 2px;\n  padding: 0.5rem 0.75rem;\n}\n.pagination .page-item.active .page-link {\n  background-color: #c62828;\n  color: #fff;\n  z-index: 3;\n}\n.pagination .page-item.disabled .page-link {\n  color: #ced4da;\n}\n.pagination .page-link:hover {\n  background-color: #f1f1f1;\n}\n.column-filter-dropdown {\n  position: relative;\n}\n.column-filter-dropdown .dropdown-menu {\n  left: auto;\n  right: 0;\n  min-width: 260px;\n  box-shadow: 0 4px 24px rgba(60,60,60,0.13);\n  border-radius: 8px;\n  border: 1px solid #e0e0e0;\n  z-index: 1052;\n}\n.column-filter-dropdown .form-check {\n  user-select: none;\n}\n.fw-bold {\n  font-weight: 600 !important;\n}\n.table td {\n  vertical-align: middle;\n}\n</style>"],"names":["COLUMN_CACHE_KEY","reservations","ref","loading","filters","pagination","allColumns","selectedColumns","visibleColumns","col","showColumnDropdown","tempSelectedColumns","selectAllChecked","dropdownBtn","toggleColumnDropdown","updateSelectAllChecked","applyColumnSelection","cancelColumnSelection","toggleSelectAll","watch","selectedReservation","detailsModal","showDetails","reservation","Modal","fetchReservations","page","params","response","axios","data","current_page","last_page","per_page","total","from","to","Swal","applyFilters","goToPage","paginationWindow","computed","current","windowSize","start","end","pages","i","onMounted","cached","parsed","k","c","val"],"mappings":"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"}