import{_ as H,c as n,a as e,f as p,j as w,v as N,O as F,F as L,g as T,t as a,i as j,b as u,L as g,C as Y,P as q,T as z,N as _,S as b,o as i,n as V}from"./app-BLvk--SP.js";const O={name:"Users",setup(){const A=g([]),t=g([]),C=g(!1),l=g(null),k=g(null),M=g(null),U=g(!1),f=g({name:"",email:"",password:"",role:""}),c=g({search:"",role:"",status:""}),v=async()=>{U.value=!0;try{const o={};c.value.search&&(o.search=c.value.search),c.value.role&&(o.role=c.value.role),c.value.status&&(o.status=c.value.status);const r=await _.get("/tenant/users",{params:o});A.value=r.data.data.data}catch(o){console.error("Error fetching users:",o)}finally{U.value=!1}},x=async()=>{try{const o=await _.get("/tenant/roles");t.value=o.data.data.filter(r=>r.name!=="super_user")}catch(o){console.error("Error fetching roles:",o)}},E=()=>{C.value=!1,f.value={name:"",email:"",password:"",role:""},k.value.show()},D=o=>{var r;C.value=!0,f.value={id:o.id,name:o.name,email:o.email,password:"",role:((r=o.roles[0])==null?void 0:r.name)||""},k.value.show()},R=o=>{l.value=o,M.value.show()},s=async()=>{var o,r;try{C.value?await _.put(`/tenant/users/${f.value.id}`,f.value):await _.post("/tenant/users",f.value),await v(),k.value.hide(),b.fire({icon:"success",title:C.value?"User Updated":"User Created",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(m){console.error("Error saving user:",m),b.fire({icon:"error",title:"Error",text:((r=(o=m.response)==null?void 0:o.data)==null?void 0:r.message)||"Failed to save user"})}},S=o=>{b.fire({title:"Are you sure?",text:"This will soft delete the user. They won't be able to login but their data will be preserved.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(async r=>{var m,y;if(r.isConfirmed)try{await _.delete(`/tenant/users/${o.id}`),await v(),b.fire({icon:"success",title:"User Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(h){console.error("Error deleting user:",h),b.fire({icon:"error",title:"Error",text:((y=(m=h.response)==null?void 0:m.data)==null?void 0:y.message)||"Failed to delete user"})}})},B=o=>{b.fire({title:"Are you absolutely sure?",text:"This will permanently delete the user. This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, permanently delete!"}).then(async r=>{var m,y;if(r.isConfirmed)try{await _.delete(`/tenant/users/${o.id}/force`),await v(),b.fire({icon:"success",title:"User Permanently Deleted",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(h){console.error("Error permanently deleting user:",h),b.fire({icon:"error",title:"Error",text:((y=(m=h.response)==null?void 0:m.data)==null?void 0:y.message)||"Failed to permanently delete user"})}})},d=async o=>{var r,m;try{await _.post(`/tenant/users/${o.id}/restore`),await v(),b.fire({icon:"success",title:"User Restored",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}catch(y){console.error("Error restoring user:",y),b.fire({icon:"error",title:"Error",text:((m=(r=y.response)==null?void 0:r.data)==null?void 0:m.message)||"Failed to restore user"})}};function P(o){return o?o.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()):""}const I=()=>{v()};return Y(()=>{k.value=new q(document.getElementById("userModal")),M.value=new q(document.getElementById("viewUserModal")),v(),x(),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(o=>{new z(o)})}),{users:A,availableRoles:t,isEditing:C,selectedUser:l,form:f,showCreateModal:E,editUser:D,viewUser:R,saveUser:s,confirmDelete:S,confirmHardDelete:B,restoreUser:d,formatRoleName:P,filters:c,applyFilters:I,loading:U}}},G={class:"users-page"},J={class:"d-flex justify-content-between align-items-center mb-4"},K={class:"filter-card mb-4"},Q={class:"filter-body"},W={class:"row g-3 align-items-end"},X={class:"col-md-4"},Z={class:"col-md-4"},$=["value"],ee={class:"col-md-4"},te={class:"card"},se={class:"card-body"},le={key:0,class:"text-center py-5"},oe={key:1,class:"table-responsive"},ne={class:"table table-hover table-sm users-table"},ae={class:"fw-bold"},ie={class:"small text-muted"},re={class:"d-md-none small mt-1"},de={class:"badge bg-info"},me={class:"mt-1"},ce={class:"btn-group"},ue=["onClick"],be=["onClick"],fe=["onClick"],ve=["onClick"],pe=["onClick"],ge={class:"d-none d-md-table-cell"},ye={class:"d-none d-md-table-cell"},we={class:"badge bg-info"},_e={class:"d-none d-md-table-cell"},Ce={class:"d-none d-md-table-cell"},Ue={class:"d-none d-md-table-cell"},ke={class:"btn-group"},he=["onClick"],xe=["onClick"],Ee=["onClick"],De=["onClick"],Re=["onClick"],Se={class:"modal fade",id:"userModal",tabindex:"-1"},Be={class:"modal-dialog modal-lg"},Ne={class:"modal-content user-modal-content"},Ae={class:"modal-header user-modal-header"},Me={class:"modal-title user-modal-title"},Fe={class:"modal-body user-modal-body"},Le={class:"row g-3 mb-3"},Te={class:"col-md-6"},Ve={class:"input-group"},qe={class:"col-md-6"},Pe={class:"input-group"},Ie={class:"col-md-6"},He={class:"input-group"},je=["required","placeholder","title"],Ye={key:0,class:"text-muted"},ze={class:"col-md-6"},Oe={class:"input-group"},Ge=["value"],Je={class:"modal-footer user-modal-footer"},Ke={type:"submit",class:"btn btn-submit"},Qe={class:"modal fade",id:"viewUserModal",tabindex:"-1"},We={class:"modal-dialog"},Xe={class:"modal-content"},Ze={class:"modal-body"},$e={class:"user-details"},et={key:0};function tt(A,t,C,l,k,M){var U,f,c,v,x,E,D,R;return i(),n("div",G,[e("div",J,[t[13]||(t[13]=e("h4",{class:"mb-0"},"Manage Users",-1)),e("button",{class:"btn btn-add-user",onClick:t[0]||(t[0]=(...s)=>l.showCreateModal&&l.showCreateModal(...s))},t[12]||(t[12]=[e("i",{class:"fas fa-plus me-2"},null,-1),p("Add User ")]))]),e("div",K,[e("div",Q,[e("div",W,[e("div",X,[t[14]||(t[14]=e("label",{class:"form-label mb-1"},"Search",-1)),w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.filters.search=s),onInput:t[2]||(t[2]=(...s)=>l.applyFilters&&l.applyFilters(...s)),type:"text",class:"form-control filter-input",placeholder:"Search by name or email"},null,544),[[N,l.filters.search]])]),e("div",Z,[t[16]||(t[16]=e("label",{class:"form-label mb-1"},"Role",-1)),w(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.filters.role=s),onChange:t[4]||(t[4]=(...s)=>l.applyFilters&&l.applyFilters(...s)),class:"form-select filter-input"},[t[15]||(t[15]=e("option",{value:""},"All Roles",-1)),(i(!0),n(L,null,T(l.availableRoles,s=>(i(),n("option",{key:s.id,value:s.name},a(l.formatRoleName(s.name)),9,$))),128))],544),[[F,l.filters.role]])]),e("div",ee,[t[18]||(t[18]=e("label",{class:"form-label mb-1"},"Status",-1)),w(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.filters.status=s),onChange:t[6]||(t[6]=(...s)=>l.applyFilters&&l.applyFilters(...s)),class:"form-select filter-input"},t[17]||(t[17]=[e("option",{value:""},"All",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"deleted"},"Deleted",-1)]),544),[[F,l.filters.status]])])])])]),e("div",te,[e("div",se,[l.loading?(i(),n("div",le,t[19]||(t[19]=[e("div",{class:"spinner-border text-danger",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):(i(),n("div",oe,[e("table",ne,[t[32]||(t[32]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",{class:"d-none d-md-table-cell"},"Role"),e("th",{class:"d-none d-md-table-cell"},"Status"),e("th",{class:"d-none d-md-table-cell"},"Created At"),e("th",{class:"d-none d-md-table-cell"},"Actions")])],-1)),e("tbody",null,[(i(!0),n(L,null,T(l.users,s=>{var S,B;return i(),n("tr",{key:s.id,class:V(["d-block d-md-table-row w-100 mb-2 mb-md-0",{"table-danger":s.deleted_at}])},[e("td",null,[e("div",ae,a(s.name),1),e("div",ie,a(s.email),1),e("div",re,[e("div",null,[t[20]||(t[20]=p("Role: ")),e("span",de,a((S=s.roles[0])!=null&&S.name?l.formatRoleName(s.roles[0].name):"No Role"),1)]),e("div",null,[t[21]||(t[21]=p("Status: ")),e("span",{class:V(["badge",s.deleted_at?"bg-danger":"bg-success"])},a(s.deleted_at?"Deleted":"Active"),3)]),e("div",null,"Created: "+a(new Date(s.created_at).toLocaleDateString()),1),e("div",me,[e("div",ce,[e("button",{class:"btn btn-sm btn-action btn-view me-1",onClick:d=>l.viewUser(s)},t[22]||(t[22]=[e("i",{class:"fas fa-eye"},null,-1)]),8,ue),s.deleted_at?u("",!0):(i(),n("button",{key:0,class:"btn btn-sm btn-action btn-edit me-1",onClick:d=>l.editUser(s)},t[23]||(t[23]=[e("i",{class:"fas fa-edit"},null,-1)]),8,be)),s.deleted_at?u("",!0):(i(),n("button",{key:1,class:"btn btn-sm btn-action btn-delete me-1",onClick:d=>l.confirmDelete(s)},t[24]||(t[24]=[e("i",{class:"fas fa-trash"},null,-1)]),8,fe)),s.deleted_at?(i(),n("button",{key:2,class:"btn btn-sm btn-action btn-restore me-1",onClick:d=>l.restoreUser(s)},t[25]||(t[25]=[e("i",{class:"fas fa-undo"},null,-1)]),8,ve)):u("",!0),s.deleted_at?(i(),n("button",{key:3,class:"btn btn-sm btn-action btn-hard-delete",onClick:d=>l.confirmHardDelete(s)},t[26]||(t[26]=[e("i",{class:"fas fa-times"},null,-1)]),8,pe)):u("",!0)])])])]),e("td",ge,a(s.email),1),e("td",ye,[e("span",we,a((B=s.roles[0])!=null&&B.name?l.formatRoleName(s.roles[0].name):"No Role"),1)]),e("td",_e,[e("span",{class:V(["badge",s.deleted_at?"bg-danger":"bg-success"])},a(s.deleted_at?"Deleted":"Active"),3)]),e("td",Ce,a(new Date(s.created_at).toLocaleDateString()),1),e("td",Ue,[e("div",ke,[e("button",{class:"btn btn-sm btn-action btn-view me-1",onClick:d=>l.viewUser(s)},t[27]||(t[27]=[e("i",{class:"fas fa-eye"},null,-1)]),8,he),s.deleted_at?u("",!0):(i(),n("button",{key:0,class:"btn btn-sm btn-action btn-edit me-1",onClick:d=>l.editUser(s)},t[28]||(t[28]=[e("i",{class:"fas fa-edit"},null,-1)]),8,xe)),s.deleted_at?u("",!0):(i(),n("button",{key:1,class:"btn btn-sm btn-action btn-delete me-1",onClick:d=>l.confirmDelete(s)},t[29]||(t[29]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ee)),s.deleted_at?(i(),n("button",{key:2,class:"btn btn-sm btn-action btn-restore me-1",onClick:d=>l.restoreUser(s)},t[30]||(t[30]=[e("i",{class:"fas fa-undo"},null,-1)]),8,De)):u("",!0),s.deleted_at?(i(),n("button",{key:3,class:"btn btn-sm btn-action btn-hard-delete",onClick:d=>l.confirmHardDelete(s)},t[31]||(t[31]=[e("i",{class:"fas fa-times"},null,-1)]),8,Re)):u("",!0)])])],2)}),128))])])]))])]),e("div",Se,[e("div",Be,[e("div",Ne,[e("div",Ae,[e("h5",Me,a(l.isEditing?"Edit User":"Add User"),1),t[33]||(t[33]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),e("div",Fe,[e("form",{onSubmit:t[11]||(t[11]=j((...s)=>l.saveUser&&l.saveUser(...s),["prevent"]))},[e("div",Le,[e("div",Te,[e("div",Ve,[t[34]||(t[34]=e("span",{class:"input-group-text"},[e("i",{class:"fas fa-user"})],-1)),w(e("input",{id:"userName",type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>l.form.name=s),required:"",placeholder:"Full Name","data-bs-toggle":"tooltip",title:"Enter the user's full name"},null,512),[[N,l.form.name]])])]),e("div",qe,[e("div",Pe,[t[35]||(t[35]=e("span",{class:"input-group-text"},[e("i",{class:"fas fa-envelope"})],-1)),w(e("input",{id:"userEmail",type:"email",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>l.form.email=s),required:"",placeholder:"user@email.com","data-bs-toggle":"tooltip",title:"Enter a valid email address"},null,512),[[N,l.form.email]])])]),e("div",Ie,[e("div",He,[t[36]||(t[36]=e("span",{class:"input-group-text"},[e("i",{class:"fas fa-key"})],-1)),w(e("input",{id:"userPassword",type:"password",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>l.form.password=s),required:!l.isEditing,placeholder:l.isEditing?"Leave blank to keep current password":"Password (min 8 characters)","data-bs-toggle":"tooltip",title:l.isEditing?"Leave blank to keep current password":"Password must be at least 8 characters"},null,8,je),[[N,l.form.password]])]),l.isEditing?(i(),n("small",Ye,"Leave blank to keep current password")):u("",!0)]),e("div",ze,[e("div",Oe,[t[38]||(t[38]=e("span",{class:"input-group-text"},[e("i",{class:"fas fa-user-tag"})],-1)),w(e("select",{id:"userRole",class:"form-select","onUpdate:modelValue":t[10]||(t[10]=s=>l.form.role=s),required:"","data-bs-toggle":"tooltip",title:"Select a role for this user"},[t[37]||(t[37]=e("option",{value:""},"Select Role",-1)),(i(!0),n(L,null,T(l.availableRoles,s=>(i(),n("option",{key:s.id,value:s.name},a(l.formatRoleName(s.name)),9,Ge))),128))],512),[[F,l.form.role]])])])]),e("div",Je,[t[39]||(t[39]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",Ke,a(l.isEditing?"Update":"Create"),1)])],32)])])])]),e("div",Qe,[e("div",We,[e("div",Xe,[t[46]||(t[46]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"User Details"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Ze,[e("div",$e,[e("p",null,[t[40]||(t[40]=e("strong",null,"Name:",-1)),p(" "+a((U=l.selectedUser)==null?void 0:U.name),1)]),e("p",null,[t[41]||(t[41]=e("strong",null,"Email:",-1)),p(" "+a((f=l.selectedUser)==null?void 0:f.email),1)]),e("p",null,[t[42]||(t[42]=e("strong",null,"Role:",-1)),p(" "+a((v=(c=l.selectedUser)==null?void 0:c.roles[0])!=null&&v.name?l.formatRoleName(l.selectedUser.roles[0].name):"No Role"),1)]),e("p",null,[t[43]||(t[43]=e("strong",null,"Status:",-1)),p(" "+a((x=l.selectedUser)!=null&&x.deleted_at?"Deleted":"Active"),1)]),e("p",null,[t[44]||(t[44]=e("strong",null,"Created At:",-1)),p(" "+a(new Date((E=l.selectedUser)==null?void 0:E.created_at).toLocaleString()),1)]),(D=l.selectedUser)!=null&&D.deleted_at?(i(),n("p",et,[t[45]||(t[45]=e("strong",null,"Deleted At:",-1)),p(" "+a(new Date((R=l.selectedUser)==null?void 0:R.deleted_at).toLocaleString()),1)])):u("",!0)])]),t[47]||(t[47]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])])])}const lt=H(O,[["render",tt],["__scopeId","data-v-767d0b46"]]);export{lt as default};
//# sourceMappingURL=Users-BpwV6cNF.js.map
