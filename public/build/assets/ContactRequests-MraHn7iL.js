import{_ as Y,L as r,z as B,B as G,C as Q,T as X,c as a,a as e,j as N,v as Z,f as b,n as x,J as V,F as c,g as y,b as $,t as d,N as ee,S as q,o,P as te}from"./app-BLvk--SP.js";const se={class:"Reservations-page"},le={class:"mb-4"},ae={class:"filter-body"},oe={class:"row g-3 align-items-end flex-nowrap"},ne={class:"col-md-6"},ie={class:"col-md-6 d-flex align-items-end justify-content-end"},de={class:"dropdown column-filter-dropdown ms-auto"},re={class:"form-check mb-2"},ce=["id","value"],ue=["for"],pe={class:"card"},me={class:"card-body"},ve={key:0,class:"text-center py-5"},be={key:1,class:"text-center py-5 text-muted"},ye={key:2,class:"table-responsive"},ge={class:"table table-hover table-sm Reservations-table"},_e={class:"fw-bold"},fe={class:"small text-muted d-flex align-items-center"},ke=["onClick"],he=["onClick"],Ce=["title"],we=["onClick"],xe={key:3,class:"d-flex justify-content-between align-items-center mt-3"},Se={class:"text-muted"},Me={key:0},Ae={class:"pagination mb-0"},je=["disabled"],Ee=["onClick"],Ne=["disabled"],qe={class:"modal fade",id:"detailsModal",tabindex:"-1"},De={class:"modal-dialog"},Te={class:"modal-content"},Be={class:"modal-body"},Ve={class:"table table-bordered"},$e={key:0},Le={key:1},L="contactreqs_selected_columns_v1",Re={__name:"ContactRequests",setup(Fe){const g=r([]),S=r(!1),M=r({search:""}),n=r({current_page:1,last_page:1,per_page:8,total:0,from:0,to:0}),v=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"subject",label:"Subject"},{key:"message",label:"Message"},{key:"created_at",label:"Created At"}],u=r(["name","subject","message"]),k=r(v.filter(l=>u.value.includes(l.key))),_=r(!1),p=r([...u.value]),h=r(!1),R=r(null),F=()=>{_.value=!_.value,p.value=[...u.value],D()},I=()=>{u.value=[...p.value],k.value=v.filter(l=>u.value.includes(l.key)),_.value=!1},P=()=>{p.value=[...u.value],_.value=!1},O=()=>{h.value?p.value=v.map(l=>l.key):p.value=[]},D=()=>{h.value=p.value.length===v.length};B(p,D);const C=r({});let A=null;const U=l=>{C.value=l,A||(A=new te(document.getElementById("detailsModal"))),A.show()},T=(l,s)=>{navigator.clipboard.writeText(l).then(()=>{q.fire({icon:"success",title:"Copied!",text:`${s} copied to clipboard.`,toast:!0,position:"top-end",showConfirmButton:!1,timer:1200})}).catch(()=>{q.fire({icon:"error",title:"Error",text:`Failed to copy ${s.toLowerCase()}.`})})},j=async(l=1)=>{S.value=!0;try{const s={page:l,per_page:n.value.per_page,search:M.value.search},t=await ee.get("/tenant/contacts-list",{params:s});if(t.data.success){const{data:i,current_page:m,last_page:w,per_page:f,total:K,from:H,to:W}=t.data.data;g.value=i,n.value={current_page:m,last_page:w,per_page:f,total:K,from:H,to:W}}else g.value=[],n.value={current_page:1,last_page:1,per_page:8,total:0,from:0,to:0}}catch{g.value=[],q.fire({icon:"error",title:"Error",text:"Failed to fetch contact requests."})}finally{S.value=!1}},z=()=>{j(1)},E=l=>{l<1||l>n.value.last_page||j(l)},J=G(()=>{const l=n.value.last_page,s=n.value.current_page,t=5;let i=Math.max(1,s-2),m=Math.min(l,s+2);m-i<t-1&&(i===1?m=Math.min(l,i+t-1):m===l&&(i=Math.max(1,m-t+1)));const w=[];for(let f=i;f<=m;f++)w.push(f);return w});return Q(()=>{const l=localStorage.getItem(L);if(l)try{const s=JSON.parse(l);Array.isArray(s)&&s.every(t=>v.some(i=>i.key===t))&&(u.value=s,k.value=v.filter(t=>u.value.includes(t.key)))}catch{}j(),setTimeout(()=>{document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(s=>{new X(s)})},500)}),B(u,l=>{localStorage.setItem(L,JSON.stringify(l))}),(l,s)=>(o(),a("div",se,[s[16]||(s[16]=e("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e("h4",{class:"mb-0"},"Contact Requests")],-1)),e("div",le,[e("div",ae,[e("div",oe,[e("div",ne,[s[5]||(s[5]=e("label",{class:"form-label mb-1"},"Search",-1)),N(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>M.value.search=t),onInput:z,type:"text",class:"form-control filter-input",placeholder:"Search by name, email, phone, subject, or message"},null,544),[[Z,M.value.search]])]),e("div",ie,[e("div",de,[e("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button",onClick:F,ref_key:"dropdownBtn",ref:R},s[6]||(s[6]=[e("i",{class:"fas fa-filter me-1"},null,-1),b(" Columns ")]),512),e("div",{class:x(["dropdown-menu p-3",{show:_.value}]),style:{"min-width":"260px","max-height":"320px","overflow-y":"auto"}},[e("div",re,[N(e("input",{class:"form-check-input",type:"checkbox",id:"selectAllCols","onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),onChange:O},null,544),[[V,h.value]]),s[7]||(s[7]=e("label",{class:"form-check-label",for:"selectAllCols"},"(Select All)",-1))]),(o(),a(c,null,y(v,t=>e("div",{key:t.key,class:"form-check mb-1"},[N(e("input",{class:"form-check-input",type:"checkbox",id:"col-"+t.key,"onUpdate:modelValue":s[2]||(s[2]=i=>p.value=i),value:t.key},null,8,ce),[[V,p.value]]),e("label",{class:"form-check-label",for:"col-"+t.key},d(t.label),9,ue)])),64)),e("div",{class:"d-flex justify-content-end gap-2 mt-3"},[e("button",{class:"btn btn-sm btn-primary",onClick:I},"OK"),e("button",{class:"btn btn-sm btn-secondary",onClick:P},"Cancel")])],2)])])])])]),e("div",pe,[e("div",me,[S.value?(o(),a("div",ve,s[8]||(s[8]=[e("div",{class:"spinner-border text-danger",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):g.value.length===0?(o(),a("div",be,s[9]||(s[9]=[e("i",{class:"fas fa-store fa-3x mb-3",style:{color:"#bdbdbd"}},null,-1),e("div",{class:"h5 mb-2"},"No Contact Requests Found",-1),e("div",null,[b("No contact requests match your search criteria."),e("br"),b("Try adjusting your filters.")],-1)]))):(o(),a("div",ye,[e("table",ge,[e("thead",null,[e("tr",null,[(o(!0),a(c,null,y(k.value,t=>(o(),a("th",{key:t.key},d(t.label),1))),128)),s[10]||(s[10]=e("th",null,"Action",-1))])]),e("tbody",null,[(o(!0),a(c,null,y(g.value,t=>(o(),a("tr",{key:t.id},[(o(!0),a(c,null,y(k.value,i=>(o(),a("td",{key:i.key},[i.key==="name"?(o(),a(c,{key:0},[e("div",_e,d(t.name),1),e("div",fe,[e("span",null,d(t.email),1),e("button",{class:"btn btn-link btn-copy p-0 ms-1",onClick:m=>T(t.email,"Email"),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Copy Email"},s[11]||(s[11]=[e("i",{class:"fas fa-copy"},null,-1)]),8,ke)])],64)):i.key==="phone"?(o(),a(c,{key:1},[e("span",null,d(t.phone),1),e("button",{class:"btn btn-link btn-copy p-0 ms-2",onClick:m=>T(t.phone,"Phone"),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Copy Phone"},s[12]||(s[12]=[e("i",{class:"fas fa-copy"},null,-1)]),8,he)],64)):i.key==="message"?(o(),a("span",{key:2,title:t.message,"data-bs-toggle":"tooltip","data-bs-placement":"top"},d(t.message.length>18?t.message.slice(0,18)+"...":t.message),9,Ce)):i.key==="created_at"?(o(),a(c,{key:3},[b(d(t.created_at?new Date(t.created_at).toLocaleString():""),1)],64)):(o(),a(c,{key:4},[b(d(t[i.key]),1)],64))]))),128)),e("td",null,[e("button",{class:"btn btn-sm btn-primary",onClick:i=>U(t),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"View Details"},s[13]||(s[13]=[e("i",{class:"fas fa-eye"},null,-1),b(" View")]),8,we)])]))),128))])])])),n.value.total>0?(o(),a("div",xe,[e("div",Se," Showing "+d(n.value.from)+" to "+d(n.value.to)+" of "+d(n.value.total)+" entries ",1),n.value.last_page>1?(o(),a("nav",Me,[e("ul",Ae,[e("li",{class:x(["page-item",{disabled:n.value.current_page===1}])},[e("button",{class:"page-link",onClick:s[3]||(s[3]=t=>E(n.value.current_page-1)),disabled:n.value.current_page===1},"«",8,je)],2),(o(!0),a(c,null,y(J.value,t=>(o(),a("li",{key:t,class:x(["page-item",{active:t===n.value.current_page}])},[e("button",{class:"page-link",onClick:i=>E(t)},d(t),9,Ee)],2))),128)),e("li",{class:x(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("button",{class:"page-link",onClick:s[4]||(s[4]=t=>E(n.value.current_page+1)),disabled:n.value.current_page===n.value.last_page},"»",8,Ne)],2)])])):$("",!0)])):$("",!0)])]),e("div",qe,[e("div",De,[e("div",Te,[s[14]||(s[14]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Contact Request Details"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",Be,[e("table",Ve,[e("tbody",null,[(o(),a(c,null,y(v,t=>e("tr",{key:t.key},[e("th",null,d(t.label),1),e("td",null,[t.key==="created_at"&&C.value.created_at?(o(),a("span",$e,d(new Date(C.value.created_at).toLocaleString()),1)):(o(),a("span",Le,d(C.value[t.key]),1))])])),64))])])]),s[15]||(s[15]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])])]))}},Pe=Y(Re,[["__scopeId","data-v-8458dfb6"]]);export{Pe as default};
//# sourceMappingURL=ContactRequests-MraHn7iL.js.map
