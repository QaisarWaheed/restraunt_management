import{_ as J,c as o,a as e,j as D,v as q,O as z,f as r,F as c,g as k,b as F,t as n,n as S,L as m,C as W,N as L,B as H,S as A,P as K,o as a,J as Y}from"./app-BLvk--SP.js";const B="customers_selected_columns_v1",G={name:"Customers",setup(){const f=m([]),t=m(!1),b=m({search:"",status:""}),l=m(null),_=m(!1);let w=null;const s=m({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),u=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"device_info",label:"Device Info"},{key:"status",label:"Status"},{key:"created_at",label:"Created At"},{key:"creator",label:"Created By"}],N=["name","email","phone"],p=m([]),h=m([]),I=m([]);W(()=>{const i=localStorage.getItem(B);i?p.value=JSON.parse(i):p.value=[...N],h.value=[...p.value],T(),M(1)});const T=()=>{I.value=u.filter(i=>p.value.includes(i.key))},E=()=>{p.value=[...h.value],localStorage.setItem(B,JSON.stringify(p.value)),T()},M=async(i=1)=>{t.value=!0;try{const d={page:i,per_page:s.value.per_page};b.value.search&&(d.search=b.value.search),b.value.status&&(d.status=b.value.status);const y=await L.get("/tenant/customers",{params:d});if(y.data.success){const{data:g,current_page:v,last_page:x,per_page:C,total:V,from:j,to:O}=y.data.data;f.value=g,s.value={current_page:v,last_page:x,per_page:C,total:V,from:j,to:O}}else f.value=[],s.value={current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}}catch{f.value=[],s.value={current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}}finally{t.value=!1}},P=i=>{i<1||i>s.value.last_page||M(i)},U=H(()=>{const i=s.value.last_page,d=s.value.current_page,y=5;let g=Math.max(1,d-2),v=Math.min(i,d+2);v-g<y-1&&(g===1?v=Math.min(i,g+y-1):v===i&&(g=Math.max(1,v-y+1)));const x=[];for(let C=g;C<=v;C++)x.push(C);return x});return{customers:f,loading:t,filters:b,selectedCustomer:l,customerLoading:_,viewCustomer:async i=>{_.value=!0,l.value=null,w||(w=new K(document.getElementById("viewCustomerModal"))),w.show();try{const d=await L.get(`/tenant/customers/${i}`);l.value=d.data.data}catch{l.value=null}finally{_.value=!1}},applyFilters:()=>{M(1)},allColumns:u,selectedColumns:p,tempSelectedColumns:h,visibleColumns:I,applyColumnSelection:E,copyToClipboard:(i,d)=>{navigator.clipboard.writeText(i).then(()=>{A.fire({icon:"success",title:"Copied!",text:`${d} copied to clipboard.`,toast:!0,position:"top-end",showConfirmButton:!1,timer:1200})}).catch(()=>{A.fire({icon:"error",title:"Error",text:`Failed to copy ${d.toLowerCase()}.`})})},pagination:s,goToPage:P,paginationWindow:U}}},Q={class:"Customers-page"},R={class:"mb-4"},X={class:"filter-body row g-3 align-items-end flex-wrap"},Z={class:"col-12 col-md-4 mb-2 mb-md-0"},$={class:"col-12 col-md-3 mb-2 mb-md-0"},ee={class:"col-12 col-md-3 ms-auto d-flex justify-content-md-end justify-content-start align-items-end"},te={class:"dropdown column-filter-dropdown w-100 w-md-auto"},le={class:"dropdown-menu theme-dropdown shadow-lg p-2","aria-labelledby":"columnDropdown",style:{"min-width":"220px"}},se={class:"dropdown-item mb-0 d-flex align-items-center gap-2"},oe=["value"],ae={class:"card"},ne={class:"card-body"},ie={key:0,class:"text-center py-5"},re={key:1,class:"text-center py-5 text-muted"},de={key:2,class:"table-responsive"},ue={class:"table table-hover table-sm customers-table"},me=["onClick"],ce={key:0,class:"d-flex justify-content-between align-items-center mt-3"},pe={class:"text-muted"},ge={key:0},ve={class:"pagination mb-0"},be=["disabled"],ye=["onClick"],fe=["disabled"],Ce={class:"modal fade",id:"viewCustomerModal",tabindex:"-1"},ke={class:"modal-dialog"},_e={class:"modal-content"},we={class:"modal-body"},xe={key:0,class:"text-center py-4"},Se={key:1},he={key:2,class:"text-muted"};function Me(f,t,b,l,_,w){return a(),o("div",Q,[t[31]||(t[31]=e("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e("h4",{class:"mb-0"},"Manage Customers")],-1)),e("div",R,[e("div",X,[e("div",Z,[t[8]||(t[8]=e("label",{class:"form-label mb-1"},"Search",-1)),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.filters.search=s),onInput:t[1]||(t[1]=(...s)=>l.applyFilters&&l.applyFilters(...s)),type:"text",class:"form-control filter-input",placeholder:"Search by name or description"},null,544),[[q,l.filters.search]])]),e("div",$,[t[10]||(t[10]=e("label",{class:"form-label mb-1"},"Status",-1)),D(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.filters.status=s),onChange:t[3]||(t[3]=(...s)=>l.applyFilters&&l.applyFilters(...s)),class:"form-select filter-input"},t[9]||(t[9]=[e("option",{value:""},"All",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),544),[[z,l.filters.status]])]),e("div",ee,[e("div",te,[t[12]||(t[12]=e("button",{class:"btn btn-theme btn-sm dropdown-toggle w-100",type:"button",id:"columnDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fas fa-columns"}),r(" Columns ")],-1)),e("ul",le,[(a(!0),o(c,null,k(l.allColumns,s=>(a(),o("li",{key:s.key},[e("label",se,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=u=>l.tempSelectedColumns=u),value:s.key,class:"form-check-input"},null,8,oe),[[Y,l.tempSelectedColumns]]),e("span",null,n(s.label),1)])]))),128)),t[11]||(t[11]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("button",{class:"btn btn-theme w-100",onClick:t[5]||(t[5]=(...s)=>l.applyColumnSelection&&l.applyColumnSelection(...s))},"Apply")])])])])])]),e("div",ae,[e("div",ne,[l.loading?(a(),o("div",ie,t[13]||(t[13]=[e("div",{class:"spinner-border text-danger",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):l.customers.length===0?(a(),o("div",re,t[14]||(t[14]=[e("i",{class:"fas fa-users fa-3x mb-3",style:{color:"#bdbdbd"}},null,-1),e("div",{class:"h5 mb-2"},"No Customers Found",-1),e("div",null,[r("No customers match your search criteria."),e("br"),r("Try adjusting your filters.")],-1)]))):(a(),o("div",de,[e("table",ue,[e("thead",null,[e("tr",null,[(a(!0),o(c,null,k(l.visibleColumns,s=>(a(),o("th",{key:s.key},n(s.label),1))),128))])]),e("tbody",null,[(a(!0),o(c,null,k(l.customers,s=>(a(),o("tr",{key:s.id},[(a(!0),o(c,null,k(l.visibleColumns,u=>(a(),o("td",{key:u.key},[u.key==="email"?(a(),o(c,{key:0},[r(n(s.email)+" ",1),e("button",{class:"btn btn-link btn-sm p-0 ms-1 copy-btn",onClick:N=>l.copyToClipboard(s.email,"Email"),title:"Copy Email"},t[15]||(t[15]=[e("i",{class:"fas fa-copy"},null,-1)]),8,me)],64)):u.key==="created_at"?(a(),o(c,{key:1},[r(n(new Date(s.created_at).toLocaleDateString()),1)],64)):u.key==="status"?(a(),o("span",{key:2,class:S(["badge",s.status==="active"?"bg-success":"bg-danger"])},n(s.status==="active"?"Active":"Inactive"),3)):(a(),o(c,{key:3},[r(n(s[u.key]),1)],64))]))),128))]))),128))])]),l.pagination.total>0?(a(),o("div",ce,[e("div",pe," Showing "+n(l.pagination.from)+" to "+n(l.pagination.to)+" of "+n(l.pagination.total)+" entries ",1),l.pagination.last_page>1?(a(),o("nav",ge,[e("ul",ve,[e("li",{class:S(["page-item",{disabled:l.pagination.current_page===1}])},[e("button",{class:"page-link",onClick:t[6]||(t[6]=s=>l.goToPage(l.pagination.current_page-1)),disabled:l.pagination.current_page===1},"«",8,be)],2),(a(!0),o(c,null,k(l.paginationWindow,s=>(a(),o("li",{key:s,class:S(["page-item",{active:s===l.pagination.current_page}])},[e("button",{class:"page-link",onClick:u=>l.goToPage(s)},n(s),9,ye)],2))),128)),e("li",{class:S(["page-item",{disabled:l.pagination.current_page===l.pagination.last_page}])},[e("button",{class:"page-link",onClick:t[7]||(t[7]=s=>l.goToPage(l.pagination.current_page+1)),disabled:l.pagination.current_page===l.pagination.last_page},"»",8,fe)],2)])])):F("",!0)])):F("",!0)]))])]),e("div",Ce,[e("div",ke,[e("div",_e,[t[29]||(t[29]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Customer Details"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",we,[l.customerLoading?(a(),o("div",xe,t[16]||(t[16]=[e("div",{class:"spinner-border text-danger",role:"status"},null,-1)]))):l.selectedCustomer?(a(),o("div",Se,[e("p",null,[t[17]||(t[17]=e("strong",null,"ID:",-1)),r(" "+n(l.selectedCustomer.id),1)]),e("p",null,[t[18]||(t[18]=e("strong",null,"Unique ID:",-1)),r(" "+n(l.selectedCustomer.unique_id),1)]),e("p",null,[t[19]||(t[19]=e("strong",null,"Name:",-1)),r(" "+n(l.selectedCustomer.name),1)]),e("p",null,[t[20]||(t[20]=e("strong",null,"Email:",-1)),r(" "+n(l.selectedCustomer.email),1)]),e("p",null,[t[21]||(t[21]=e("strong",null,"Phone:",-1)),r(" "+n(l.selectedCustomer.phone),1)]),e("p",null,[t[22]||(t[22]=e("strong",null,"Device Info:",-1)),r(" "+n(l.selectedCustomer.device_info),1)]),e("p",null,[t[23]||(t[23]=e("strong",null,"Address:",-1)),r(" "+n(l.selectedCustomer.address),1)]),e("p",null,[t[24]||(t[24]=e("strong",null,"Status:",-1)),r(" "+n(l.selectedCustomer.status),1)]),e("p",null,[t[25]||(t[25]=e("strong",null,"Created By:",-1)),r(" "+n(l.selectedCustomer.creator?l.selectedCustomer.creator.name:"-"),1)]),e("p",null,[t[26]||(t[26]=e("strong",null,"Created At:",-1)),r(" "+n(new Date(l.selectedCustomer.created_at).toLocaleString()),1)]),e("p",null,[t[27]||(t[27]=e("strong",null,"Updated By:",-1)),r(" "+n(l.selectedCustomer.updater?l.selectedCustomer.updater.name:"-"),1)]),e("p",null,[t[28]||(t[28]=e("strong",null,"Updated At:",-1)),r(" "+n(new Date(l.selectedCustomer.updated_at).toLocaleString()),1)])])):(a(),o("div",he,"No customer details available."))]),t[30]||(t[30]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])])])}const Fe=J(G,[["render",Me],["__scopeId","data-v-80866395"]]);export{Fe as default};
//# sourceMappingURL=Customers-DD1_NxRY.js.map
